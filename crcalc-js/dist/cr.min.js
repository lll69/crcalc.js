/*!
 * crcalc.js
 * Copyright 2025 lll69, Licensed under the Apache License, Version 2.0
 * Copyright (C) 2016 The Android Open Source Project, Licensed under the Apache License, Version 2.0
 * Copyright (C) 2015 The Android Open Source Project, Licensed under the Apache License, Version 2.0
 * Copyright (c) 1999, Silicon Graphics, Inc.
 * Copyright (c) 2001-2004, Hewlett-Packard Development Company, L.P.
 */
const t=Math,e=t.LN2,r=t.abs,n=t.ceil,i=t.floor,s=t.log,a=t.max,l=t.random,u=t.round,o=t.sqrt,c=BigInt,h=Number;class m extends Error{constructor(t,e){super(t+(e?": "+e:e))}}class p extends m{constructor(t){super("PrecisionOverflowException",t)}}class f extends m{constructor(t){super("ArithmeticException",t)}}class g extends m{constructor(t){super("NumberFormatException",t)}}class R extends f{constructor(){super("Division by zero")}}class _ extends m{constructor(t){super("AssertionError",t)}}function w(t){return t<0n?-t:t}function d(t,e){return t<e?-1:t===e?0:1}function N(t){return t<0n?-1:0n===t?0:1}function F(t){if(0n===t)return 0;t<0n&&(t=-1n-t);let e=0,r=t>>1048576n;for(;0n!==r;)e+=1048576,r=(t=r)>>1048576n;for(r=t>>1024n;0n!==r;)e+=1024,r=(t=r)>>1024n;for(r=t>>64n;0n!==r;)e+=64,r=(t=r)>>64n;let n,i=0n,s=64n;for(;i<s;)n=i+s+1n>>1n,t>>n===0n?s=n-1n:i=n;return e+h(i)+1}function C(t,e){return 0n===e?t:e<0n?t>>-e:t<<e}function O(t,e){if(e>=0n)return t<<e;return C(t,e+1n)+1n>>1n}class E{constructor(){this.min_prec=0,this.appr_valid=!1}static bound_log2(t){let i=r(t);return 0^n(s(i+1)/e)}static check_prec(t){if(t>>28^t>>29)throw new p}static valueOfN(t){return new x(t)}setMaxAppr(t){this.max_appr=t,this.maxApprBitLen=-1}getApprBitLen(){let t=this.maxApprBitLen;return-1===t&&(t=this.max_appr>=0n?F(this.max_appr):F(-this.max_appr),this.maxApprBitLen=t),t}get_appr(t){if(E.check_prec(t),this.appr_valid&&t>=this.min_prec)return O(this.max_appr,c(this.min_prec-t));{let e=this.approximate(t);return this.min_prec=t,this.setMaxAppr(e),this.appr_valid=!0,e}}known_msd(){let t=this.getApprBitLen();return this.min_prec+t-1}msd(t){return(!this.appr_valid||this.max_appr<=1n&&this.max_appr>=-1n)&&(this.get_appr(t-1),w(this.max_appr)<=1n)?-2147483648:this.known_msd()}iter_msd(t){let e,r=0;for(;r>t+30;r=(3*r>>1)-16){if(e=this.msd(r),-2147483648!==e)return e;E.check_prec(r)}return this.msd(t)}msd_get(){return this.iter_msd(-2147483648)}static zeroes(t){let e="";for(let r=0;r<t;++r)e+="0";return e}simple_ln(){return new q(this.subtract(E.ONE))}static atan_reciprocal(t){return new V(t)}compareToRA(t,e,r){let n=this.iter_msd(r),i=t.iter_msd(n>r?n:r),s=i>n?i:n;if(-2147483648===s)return 0;E.check_prec(e);let a=s+e,l=a>r?a:r;return this.compareToA(t,l)}compareToA(t,e){let r=e-1,n=this.get_appr(r),i=t.get_appr(r);return d(n,i+1n)>0?1:d(n,i-1n)<0?-1:0}compareTo(t){for(let e=-20;;e*=2){E.check_prec(e);let r=this.compareToA(t,e);if(0!==r)return r}}signumA(t){if(this.appr_valid){let t=N(this.max_appr);if(0!==t)return t}let e=t-1;return N(this.get_appr(e))}signum(){for(let t=-20;;t*=2){E.check_prec(t);let e=this.signumA(t);if(0!==e)return e}}static valueOfS(t,e){if(void 0===e&&(e=10),2!==e&&8!==e&&10!==e&&16!==e)throw new g("Radix: "+e);let r,n,i=t.length,s=0;for(;" "===t.charAt(s);)++s;for(;" "===t.charAt(i-1);)--i;r=t.indexOf(".",s),-1===r?(r=i,n=""):n=t.substring(r+1,i);let a,l=t.substring(s,r);switch(e){case 2:a=c("0b"+l+n);break;case 8:a=c("0o"+l+n);break;case 10:a=c(l+n);break;case 16:a=c("0x"+l+n)}let u=c(e)**c(n.length);return E.valueOfN(a).divide(E.valueOfN(u))}toStringR(t,e){let r;if(16===e)r=this.shiftLeft(4*t);else{let n=c(e)**c(t);r=this.multiply(new x(n))}let n,i=r.get_appr(0),s=w(i).toString(e);if(0===t)n=s;else{let e=s.length;if(e<=t){s=E.zeroes(t+1-e)+s,e=t+1}n=s.substring(0,e-t)+"."+s.substring(e-t)}return i<0n&&(n="-"+n),n}toStringD(t){return this.toStringR(t,10)}toString(){return this.toStringD(10)}BigIntegerValue(){return this.get_appr(0)}doubleValue(){let t=this.iter_msd(-1080);if(-2147483648===t)return 0;let e=t-60,r=h(this.get_appr(e)),n=e<-1e3,i=new ArrayBuffer(8),s=new DataView(i);s.setFloat64(0,r);let a=s.getBigInt64(0),l=c(n?e+96:e);if((a>>52n&0x7ffn)+l>=2047)return r<0?-1/0:1/0;a+=l<<52n,s.setBigInt64(0,a);let u=s.getFloat64(0);if(n){const t=h(1n<<48n);return u/t/t}return u}add(t){return new T(this,t)}shiftLeft(t){return E.check_prec(t),new b(this,t)}shiftRight(t){return E.check_prec(t),new b(this,-t)}assumeInt(){return new y(this)}negate(){return new I(this)}subtract(t){return new T(this,t.negate())}multiply(t){return new A(this,t)}inverse(){return new P(this)}divide(t){return new A(this,t.inverse())}select(t,e){return new S(this,t,e)}max(t){return this.subtract(t).select(t,this)}min(t){return this.subtract(t).select(this,t)}abs(){return this.select(this.negate(),this)}exp(){let t=this.get_appr(-10);if(t>2n||t<-2n){let t=this.shiftRight(1).exp();return t.multiply(t)}return new D(this)}cos(){let t=this.divide(E.PI).get_appr(-1);if(w(t)>=2n){let e=O(t,-1n),r=E.PI.multiply(E.valueOfN(e));return 0n!==(1n&e)?this.subtract(r).cos().negate():this.subtract(r).cos()}if(w(this.get_appr(-1))>=2n){let t=this.shiftRight(1).cos();return t.multiply(t).shiftLeft(1).subtract(E.ONE)}return new L(this)}sin(){return E.half_pi.subtract(this).cos()}asin(){let t=this.get_appr(-10);if(t>750n){return E.ONE.subtract(this.multiply(this)).sqrt().acos()}return t<-750n?this.negate().asin().negate():new B(this)}acos(){return E.half_pi.subtract(this.asin())}ln(){let t=this.get_appr(-4);if(t<0n)throw new f("ln(negative)");if(t<=8n)return this.inverse().ln().negate();if(t>=24n){if(t<=64n){return this.sqrt().sqrt().ln().shiftLeft(2)}{let e=F(t)-3;return this.shiftRight(e).ln().add(E.valueOfN(c(e)).multiply(E.ln2))}}return this.simple_ln()}sqrt(){return new H(this)}}class v extends E{get_appr(t){if(v.check_prec(t),this.appr_valid&&t>=this.min_prec)return O(this.max_appr,c(this.min_prec-t));{let e=t>=-64?-64:t-32+1&-32,r=this.approximate(e);return this.min_prec=e,this.setMaxAppr(r),this.appr_valid=!0,O(r,c(e-t))}}}class x extends E{constructor(t){super(),this.value=t}approximate(t){return O(this.value,c(-t))}}class y extends E{constructor(t){super(),this.value=t}approximate(t){return t>=0?this.value.get_appr(t):O(this.value.get_appr(0),c(-t))}}class T extends E{constructor(t,e){super(),this.op1=t,this.op2=e}approximate(t){return O(this.op1.get_appr(t-2)+this.op2.get_appr(t-2),-2n)}}class b extends E{constructor(t,e){super(),this.op=t,this.count=e}approximate(t){return this.op.get_appr(t-this.count)}}class I extends E{constructor(t){super(),this.op=t}approximate(t){return-this.op.get_appr(t)}negate(){return this.op}}class S extends E{constructor(t,e,r){super(),this.selector=t,this.selector_sign=N(t.get_appr(-20)),this.op1=e,this.op2=r}approximate(t){if(this.selector_sign<0)return this.op1.get_appr(t);if(this.selector_sign>0)return this.op2.get_appr(t);let e=this.op1.get_appr(t-1),r=this.op2.get_appr(t-1);return w(e-r)<=1n?O(e,-1n):this.selector.signum()<0?(this.selector_sign=-1,O(e,-1n)):(this.selector_sign=1,O(r,-1n))}}class A extends E{constructor(t,e){super(),this.op1=t,this.op2=e}approximate(t){let e,r=(t>>1)-1,n=this.op1.msd(r);if(-2147483648===n){if(e=this.op2.msd(r),-2147483648===e)return 0n;{let t;t=this.op1,this.op1=this.op2,this.op2=t,n=e}}let i=t-n-3,s=this.op2.get_appr(i);if(0n===s)return 0n;e=this.op2.known_msd();let a=t-e-3;return O(this.op1.get_appr(a)*s,c(a+i-t))}}class P extends E{constructor(t){super(),this.op=t}approximate(t){let e=this.op.msd_get(),r=e-(1-e-t+3),n=-t-r;if(n<0)return 0n;let i=1n<<c(n),s=this.op.get_appr(r),a=w(s),l=(i+(a>>1n))/a;return s<0?-l:l}}class D extends E{constructor(t){super(),this.op=t}approximate(t){if(t>=1)return 0n;let e=2+(-t>>1),r=t-D.bound_log2(2*e)-4,n=t-3,i=this.op.get_appr(n),s=c(n),a=1n<<c(-r),l=a,u=a,o=0,h=1n<<c(t-4-r);for(;w(l)>=h;)o=o+1^0,l=O(l*i,s),l/=c(o),u+=l;return O(u,c(r-t))}}class L extends v{constructor(t){super(),this.op=t}approximate(t){if(t>=1)return 0n;let e,r,n=4+(-t>>1),i=t-L.bound_log2(2*n)-4,s=t-2,a=this.op.get_appr(s),l=c(s),u=1n<<c(t-4-i);r=0,e=1n<<c(-i);let o=e;for(;w(e)>=u;){r+=2,e=O(e*a,l),e=O(e*a,l),e/=c(-r)*c(r-1),o+=e}return O(o,c(i-t))}}class V extends v{constructor(t){super(),this.op=t}approximate(t){if(t>=1)return 0n;let e=2+(-t>>1),r=t-V.bound_log2(2*e)-2,n=1n<<c(-r),i=c(this.op),s=c(this.op*this.op),a=n/i,l=a,u=a,o=a,h=1,m=1,p=1n<<c(t-2-r);for(;w(u)>=p;)m+=2,l/=s,h=-h,u=l/c(h*m),o+=u;return O(o,c(r-t))}}class q extends v{constructor(t){super(),this.op=t}approximate(t){if(t>=0)return 0n;let e=-t,r=t-q.bound_log2(2*e)-4,n=t-3,i=this.op.get_appr(n),s=c(n),a=O(i,c(n-r)),l=a,u=l,o=1,h=1,m=1n<<c(t-4-r);for(;w(l)>=m;)o+=1,h=-h,a=O(a*i,s),l=a/c(o*h),u+=l;return O(u,c(r-t))}}class B extends v{constructor(t){super(),this.op=t}approximate(t){if(t>=2)return 0n;let e=-3*(t>>1)+4,r=t-B.bound_log2(2*e)-4,n=t-3,i=this.op.get_appr(n),s=c(n+2),a=c(n-2),l=1n<<c(t-4-r),u=1,o=i<<c(n-r),h=o,m=o;for(;w(o)>=l;){u+=2,m*=c(u-2),m=O(m*i,s),m*=i,m/=c(u-1),m=O(m,a),o=m/c(u),h+=o}return O(h,c(r-t))}}class H extends E{constructor(t,e=0,r=null){super(),this.op=t,this.min_prec=e,null!==r&&(this.setMaxAppr(r),this.appr_valid=!0)}approximate(t){let e=(t<<1)-1,r=this.op.iter_msd(e);if(r<=e)return 0n;let n=r>>1,s=n-t;if(s>50){let e=n-(6+(s>>1)),r=e<<1,i=this.op.get_appr(r),a=this.get_appr(e);return O(a*a+i,c(e-t))/a+1n>>1n}{let e=r-60&-2,n=e-60,s=this.op.get_appr(e)<<60n,a=h(s);if(a<0)throw new f("sqrt(negative)");let l=o(a);return C(c(i(l)),c((n>>1)-t))}}}class Z extends v{constructor(){super(),this.b_prec=[null],this.b_val=[null]}approximate(t){if(this.b_prec.length>this.b_val.length&&this.b_prec.pop(),t>=0)return O(3n,c(-t));const r=n(s(-t)/e)+10^0,i=c(-r),a=t-r,l=c(-a);let u=1n<<l,o=Z.SQRT_HALF.get_appr(a),h=1n<<c(-a-2),m=0;for(;u-o-4n>0n;){let e,r=u+o>>1n,n=u-r,s=u*o>>l,p=Z.valueOfN(s).shiftRight(-a);if(this.b_prec.length===m+1){e=p.sqrt().get_appr(a);let r=O(e,i);this.b_prec.push(t),this.b_val.push(r)}else{e=new H(p,this.b_prec[m+1],this.b_val[m+1]).get_appr(a),this.b_prec[m+1]=t,this.b_val[m+1]=O(e,i)}u=r,o=e,h=h-(n*n<<c(m+a)),++m}let p=u+o;return O(p*p/h>>2n,i)}}E.ZERO=E.valueOfN(0n),E.ONE=E.valueOfN(1n),E.ten_ninths=E.valueOfN(10n).divide(E.valueOfN(9n)),E.twentyfive_twentyfourths=E.valueOfN(25n).divide(E.valueOfN(24n)),E.eightyone_eightyeths=E.valueOfN(81n).divide(E.valueOfN(80n)),E.ln2_1=E.valueOfN(7n).multiply(E.ten_ninths.simple_ln()),E.ln2_2=E.valueOfN(2n).multiply(E.twentyfive_twentyfourths.simple_ln()),E.ln2_3=E.valueOfN(3n).multiply(E.eightyone_eightyeths.simple_ln()),E.ln2=E.ln2_1.subtract(E.ln2_2).add(E.ln2_3),E.SQRT_HALF=new H(E.ONE.shiftRight(1)),E.four=E.valueOfN(4n),E.PI=new Z,E.atan_PI=E.four.multiply(E.four.multiply(E.atan_reciprocal(5)).subtract(E.atan_reciprocal(239))),E.half_pi=E.PI.shiftRight(1);class Q{}const k=Object.freeze({sinFunction:new class extends Q{execute(t){return t.sin()}},cosFunction:new class extends Q{execute(t){return t.cos()}},tanFunction:new class extends Q{execute(t){return t.sin().divide(t.cos())}},asinFunction:new class extends Q{execute(t){return t.asin()}},acosFunction:new class extends Q{execute(t){return t.acos()}},atanFunction:new class extends Q{constructor(){super(...arguments),this.one=E.ONE}execute(t){let e=t.multiply(t),r=e.divide(this.one.add(e)).sqrt();return t.select(r.negate(),r).asin()}}});class M{constructor(t,e=1n){this.mNum=t,this.mDen=e}static valueOfS(t,e){if(void 0===e&&(e=10),2!==e&&8!==e&&10!==e&&16!==e)throw new g("Radix: "+e);let r,n,i=t.length,s=0;for(;" "===t.charAt(s);)++s;for(;" "===t.charAt(i-1);)--i;r=t.indexOf(".",s),-1===r?(r=i,n=""):n=t.substring(r+1,i);let a,l=t.substring(s,r);switch(e){case 2:a=c("0b"+l+n);break;case 8:a=c("0o"+l+n);break;case 10:a=c(l+n);break;case 16:a=c("0x"+l+n)}let u=c(e)**c(n.length);return new M(a,u)}toString(){return this.mNum.toString()+"/"+this.mDen.toString()}toNiceString(){let t=this.reduce().positiveDen(),e=t.mNum.toString();return 1n!==t.mDen&&(e+="/"+t.mDen),e}static toString(t){return null===t?"not a small rational":t.toString()}toStringTruncated(t){let e=(w(this.mNum)*10n**c(t)/w(this.mDen)).toString(),r=e.length;return r<t+1&&(e="0".repeat(t+1-r)+e,r=t+1),(this.signum()<0?"-":"")+e.substring(0,r-t)+"."+e.substring(r-t)}crValue(){return E.valueOfN(this.mNum).divide(E.valueOfN(this.mDen))}intValue(){let t=this.reduce();if(1n!==t.mDen)throw new f("intValue of non-int");return h(t.mNum)}wholeNumberBits(){return 0n===this.mNum?-2147483648:F(this.mNum)-F(this.mDen)}tooBig(){return 1n!==this.mDen&&F(this.mNum)+F(this.mDen)>1e4}positiveDen(){return this.mDen>0n?this:new M(-this.mNum,-this.mDen)}reduce(){if(1n===this.mDen)return this;let t=function(t,e){let r;for(t=t<0n?-t:t,e=e<0n?-e:e;0n!==e;)r=e,e=t%e,t=r;return t}(this.mNum,this.mDen);return new M(this.mNum/t,this.mDen/t)}static maybeReduce(t){if(null===t)return null;if(!t.tooBig()&&l()<1/16)return t;let e=t.positiveDen();return e=e.reduce(),e.tooBig()?null:e}compareTo(t){return d(this.mNum*t.mDen,t.mNum*this.mDen)*N(this.mDen)*N(t.mDen)}signum(){return N(this.mNum)*N(this.mDen)}equals(t){return null!==t&&0===this.compareTo(t)}static asBigInteger(t){return null===t?null:t.mNum%t.mDen===0n?t.mNum/t.mDen:null}static add(t,e){if(null===t||null===e)return null;let r=t.mDen*e.mDen,n=t.mNum*e.mDen+e.mNum*t.mDen;return M.maybeReduce(new M(n,r))}static negate(t){return null===t?null:new M(-t.mNum,t.mDen)}static subtract(t,e){return M.add(t,M.negate(e))}static rawMultiply(t,e){if(null===t||null===e)return null;if(t===M.ONE)return e;if(e===M.ONE)return t;let r=t.mNum*e.mNum,n=t.mDen*e.mDen;return new M(r,n)}static multiply(t,e){return M.maybeReduce(M.rawMultiply(t,e))}static inverse(t){if(null===t)return null;if(0n===t.mNum)throw new R;return new M(t.mDen,t.mNum)}static divide(t,e){return M.multiply(t,M.inverse(e))}static sqrt(t){if(null===t)return null;if((t=t.positiveDen().reduce()).mNum<0n)throw new f("sqrt(negative)");let e=u(o(h(t.mNum)));if(e===1/0)return null;let r=c(e);if(r*r!==t.mNum)return null;let n=u(o(h(t.mDen)));if(n===1/0)return null;let i=c(n);return i*i!==t.mDen?null:new M(r,i)}rawPow(t){if(1n===t)return this;if(1n===(1n&t))return M.rawMultiply(this.rawPow(t-1n),this);if(0n===t)return M.ONE;let e=this.rawPow(t>>1n),r=M.rawMultiply(e,e);return null===r||r.tooBig()?null:r}pow(t){let e=N(t);if(0===e)return M.ONE;if(1n===t)return this;let r=this.reduce().positiveDen();if(1n===r.mDen){if(0n===r.mNum)return M.ZERO;if(1n===r.mNum)return M.ONE;if(-1n===r.mNum)return 1n===(1n&t)?M.MINUS_ONE:M.ONE}return F(t)>1e3?null:e<0?M.inverse(r).rawPow(-t):r.rawPow(t)}static pow(t,e){return null===e||null===t||1n!==(e=e.reduce().positiveDen()).mDen?null:t.pow(e.mNum)}static digitsRequired(t){if(null===t)return 2147483647;let e=0,r=0;if(1n===t.mDen)return 0;let n=(t=t.reduce()).mDen;if(F(n)>1e4)return 2147483647;for(;0n===(1n&n);)++e,n>>=1n;for(;n%5n===0n;)++r,n/=5n;return 1n!==n&&-1n!==n?1e4:a(e,r)}}M.ZERO=new M(0n),M.HALF=new M(1n,2n),M.MINUS_HALF=new M(-1n,2n),M.THIRD=new M(1n,3n),M.QUARTER=new M(1n,4n),M.SIXTH=new M(1n,6n),M.ONE=new M(1n),M.MINUS_ONE=new M(-1n),M.TWO=new M(2n),M.MINUS_TWO=new M(-2n),M.TEN=new M(10n),M.TWELVE=new M(12n);const U=1n<<1000n;class W{static check(t){if(!t)throw new _}constructor(t,e){if(null===t)throw new f("Building UnifiedReal from null");this.mCrFactor=e,this.mRatFactor=t}static newCR(t){return new W(M.ONE,t)}static newBR(t){return new W(t,W.CR_ONE)}static newN(t){return W.newBR(new M(t))}static getSquare(t){const e=W.sSqrts;for(let r=0;r<e.length;++r)if(e[r]===t)return new M(c(r));return null}getExp(t){const e=W.sLogs;for(let r=0;r<e.length;++r)if(e[r]===t)return new M(c(r));return null}static crName(t){if(t===W.CR_ONE)return"";if(t===W.CR_PI)return"π";if(t===W.CR_E)return"e";const e=W.sSqrts;for(let r=0;r<e.length;++r)if(t===e[r])return"√"+r;const r=W.sLogs;for(let e=0;e<r.length;++e)if(t===r[e])return"ln("+e+")";return null}static isNamed(t){if(t===W.CR_ONE||t===W.CR_PI||t===W.CR_E)return!0;const e=W.sSqrts;for(let r=0;r<e.length;++r)if(t===e[r])return!0;const r=W.sLogs;for(let e=0;e<r.length;++e)if(t===r[e])return!0;return!1}static definitelyAlgebraic(t){return t===W.CR_ONE||null!==W.getSquare(t)}definitelyRational(){return this.mCrFactor===W.CR_ONE||0===this.mRatFactor.signum()}definitelyIrrational(){return!this.definitelyRational()&&W.isNamed(this.mCrFactor)}definitelyAlgebraic(){return W.definitelyAlgebraic(this.mCrFactor)||0===this.mRatFactor.signum()}definitelyTranscendental(){return!this.definitelyAlgebraic()&&W.isNamed(this.mCrFactor)}static definitelyIndependent(t,e){return t!==e&&(t===W.CR_E||t===W.CR_PI?W.definitelyAlgebraic(e):e===W.CR_E||e===W.CR_PI?W.definitelyAlgebraic(t):W.isNamed(t)&&W.isNamed(e))}toString(){return this.mRatFactor.toString()+"*"+this.mCrFactor.toString()}toNiceString(){if(this.mCrFactor===W.CR_ONE||0===this.mRatFactor.signum())return this.mRatFactor.toNiceString();let t=W.crName(this.mCrFactor);if(null!==t){let e=M.asBigInteger(this.mRatFactor);return null!==e?1n===e?t:this.mRatFactor.toNiceString()+t:"("+this.mRatFactor.toNiceString()+")"+t}return this.mRatFactor===M.ONE?this.mCrFactor.toString():this.crValue().toString()}exactlyDisplayable(){return null!==W.crName(this.mCrFactor)}toStringTruncated(t){if(this.mCrFactor===W.CR_ONE||this.mRatFactor===M.ZERO)return this.mRatFactor.toStringTruncated(t);const e=E.valueOfN(10n**c(t)).multiply(this.crValue());let r,n=!1;this.exactlyTruncatable()?(r=e.get_appr(0),r<0n&&(n=!0,r=-r),E.valueOfN(r).compareTo(e.abs())>0&&(r-=1n),W.check(E.valueOfN(r).compareTo(e.abs())<0)):(r=e.get_appr(-W.EXTRA_PREC),r<0n&&(n=!0,r=-r),r>>=W.EXTRA_PREC_BIG);let i=r.toString(),s=i.length;return s<t+1&&(i="0".repeat(t+1-s)+i,s=t+1),(n?"-":"")+i.substring(0,s-t)+"."+i.substring(s-t)}exactlyTruncatable(){return this.mCrFactor===W.CR_ONE||this.mRatFactor===M.ZERO||this.definitelyIrrational()}crValue(){return this.mRatFactor.crValue().multiply(this.mCrFactor)}isComparable(t){return this.mCrFactor===t.mCrFactor&&(W.isNamed(this.mCrFactor)||0!==this.mCrFactor.signumA(-1e3))||0===this.mRatFactor.signum()&&0===t.mRatFactor.signum()||W.definitelyIndependent(this.mCrFactor,t.mCrFactor)||0!==this.crValue().compareToA(t.crValue(),-1e3)}compareTo(t){if(this.definitelyZero()&&t.definitelyZero())return 0;if(this.mCrFactor===t.mCrFactor){return this.mCrFactor.signum()*this.mRatFactor.compareTo(t.mRatFactor)}return this.crValue().compareTo(t.crValue())}compareToA(t,e){return this.isComparable(t)?this.compareTo(t):this.crValue().compareToA(t.crValue(),e)}signumA(t){return this.compareToA(W.ZERO,t)}signum(){return this.compareTo(W.ZERO)}approxEquals(t,e){return this.isComparable(t)?(!W.definitelyIndependent(this.mCrFactor,t.mCrFactor)||0===this.mRatFactor.signum()&&0===t.mRatFactor.signum())&&0===this.compareTo(t):0===this.crValue().compareToA(t.crValue(),e)}definitelyEquals(t){return this.isComparable(t)&&0===this.compareTo(t)}definitelyNotEquals(t){let e=W.isNamed(this.mCrFactor),r=W.isNamed(t.mCrFactor);return e&&r?W.definitelyIndependent(this.mCrFactor,t.mCrFactor)?0!==this.mRatFactor.signum()||0!==t.mRatFactor.signum():(this.mCrFactor,t.mCrFactor,!this.mRatFactor.equals(t.mRatFactor)):0===this.mRatFactor.signum()?r&&0!==t.mRatFactor.signum():0===t.mRatFactor.signum()&&(e&&0!==this.mRatFactor.signum())}definitelyZero(){return 0===this.mRatFactor.signum()}definitelyNonZero(){return W.isNamed(this.mCrFactor)&&0!==this.mRatFactor.signum()}definitelyOne(){return this.mCrFactor===W.CR_ONE&&this.mRatFactor.equals(M.ONE)}boundedRationalValue(){return this.mCrFactor===W.CR_ONE||0===this.mRatFactor.signum()?this.mRatFactor:null}bigIntegerValue(){let t=this.boundedRationalValue();return M.asBigInteger(t)}add(t){if(this.mCrFactor===t.mCrFactor){let e=M.add(this.mRatFactor,t.mRatFactor);if(null!==e)return new W(e,this.mCrFactor)}return this.definitelyZero()?t:t.definitelyZero()?this:W.newCR(this.crValue().add(t.crValue()))}negate(){return new W(M.negate(this.mRatFactor),this.mCrFactor)}subtract(t){return this.add(t.negate())}multiply(t){if(this.mCrFactor===W.CR_ONE){let e=M.multiply(this.mRatFactor,t.mRatFactor);if(null!==e)return new W(e,t.mCrFactor)}if(t.mCrFactor===W.CR_ONE){let e=M.multiply(this.mRatFactor,t.mRatFactor);if(null!==e)return new W(e,this.mCrFactor)}if(this.definitelyZero()||t.definitelyZero())return W.ZERO;if(this.mCrFactor===t.mCrFactor){let e=W.getSquare(this.mCrFactor);if(null!==e){let r=M.multiply(M.multiply(e,this.mRatFactor),t.mRatFactor);if(null!==r)return W.newBR(r)}}let e=M.multiply(this.mRatFactor,t.mRatFactor);return null!==e?new W(e,this.mCrFactor.multiply(t.mCrFactor)):W.newCR(this.crValue().multiply(t.crValue()))}inverse(){if(this.definitelyZero())throw new R;let t=W.getSquare(this.mCrFactor);if(null!==t){let e=M.inverse(M.multiply(this.mRatFactor,t));if(null!==e)return new W(e,this.mCrFactor)}return new W(M.inverse(this.mRatFactor),this.mCrFactor.inverse())}divide(t){if(this.mCrFactor===t.mCrFactor){if(t.definitelyZero())throw new R;let e=M.divide(this.mRatFactor,t.mRatFactor);if(null!==e)return new W(e,W.CR_ONE)}return this.multiply(t.inverse())}sqrt(){if(this.definitelyZero())return W.ZERO;if(this.mCrFactor===W.CR_ONE){let t;for(let e=1;e<W.sSqrts.length;++e)if(null!==W.sSqrts[e]&&(t=M.sqrt(M.divide(this.mRatFactor,new M(c(e)))),null!==t))return new W(t,W.sSqrts[e])}return W.newCR(this.crValue().sqrt())}getPiTwelfths(){if(this.definitelyZero())return 0n;if(this.mCrFactor===W.CR_PI){let t=M.asBigInteger(M.multiply(this.mRatFactor,M.TWELVE));return null===t?null:t%24n}return null}static sinPiTwelfths(t){if(t>=12){let e=W.sinPiTwelfths(t-12);return null===e?null:e.negate()}switch(t){case 0:return W.ZERO;case 2:case 10:return W.HALF;case 3:case 9:return W.HALF_SQRT2;case 4:case 8:return W.HALF_SQRT3;case 6:return W.ONE;default:return null}}sin(){let t=this.getPiTwelfths();if(null!==t){let e=W.sinPiTwelfths(h(t));if(null!==e)return e}return W.newCR(this.crValue().sin())}static cosPiTwelfths(t){let e=t+6;return e>=24&&(e-=24),W.sinPiTwelfths(e)}cos(){let t=this.getPiTwelfths();if(null!==t){let e=W.cosPiTwelfths(h(t));if(null!==e)return e}return W.newCR(this.crValue().cos())}tan(){let t=this.getPiTwelfths();if(null!==t){let e=h(t);if(6===e||18===e)throw new f("Tangent undefined");let r=W.sinPiTwelfths(e),n=W.cosPiTwelfths(e);if(null!==r&&null!==n)return r.divide(n)}return this.sin().divide(this.cos())}checkAsinDomain(){if(this.isComparable(W.ONE)&&(this.compareTo(W.ONE)>0||this.compareTo(W.MINUS_ONE)<0))throw new f("inverse trig argument out of range")}static asinHalves(t){if(t<0)return this.asinHalves(-t).negate();switch(t){case 0:return W.ZERO;case 1:return new W(M.SIXTH,E.PI);case 2:return new W(M.HALF,E.PI)}throw new _("asinHalves: Bad argument")}asinNonHalves(){return this.compareToA(W.ZERO,-10)<0?this.negate().asinNonHalves().negate():this.definitelyEquals(W.HALF_SQRT2)?new W(M.QUARTER,W.CR_PI):this.definitelyEquals(W.HALF_SQRT3)?new W(M.THIRD,W.CR_PI):W.newCR(this.crValue().asin())}asin(){this.checkAsinDomain();const t=this.multiply(W.TWO).bigIntegerValue();return null!==t?W.asinHalves(h(t)):this.mCrFactor===E.ONE||this.mCrFactor!==W.CR_SQRT2||this.mCrFactor!==W.CR_SQRT3?this.asinNonHalves():W.newCR(this.crValue().asin())}acos(){return W.PI_OVER_2.subtract(this.asin())}atan(){if(this.compareToA(W.ZERO,-10)<0)return this.negate().atan().negate();const t=this.bigIntegerValue();if(null!==t&&t<=1n){switch(h(t)){case 0:return W.ZERO;case 1:return W.PI_OVER_4;default:throw new _("Impossible r_int")}}return this.definitelyEquals(W.THIRD_SQRT3)?W.PI_OVER_6:this.definitelyEquals(W.SQRT3)?W.PI_OVER_3:W.newCR(k.atanFunction.execute(this.crValue()))}static recursivePow(t,e){if(1n===e)return t;if(0n!==(1n&e))return t.multiply(W.recursivePow(t,e-1n));let r=W.recursivePow(t,e>>1n);return r.multiply(r)}expLnPow(t){let e=this.signumA(-1e3);if(e>0)return W.newCR(this.crValue().ln().multiply(E.valueOfN(t)).exp());if(e<0){let e=this.crValue().negate().ln().multiply(E.valueOfN(t)).exp();return 0n!==(1n&t)&&(e=e.negate()),W.newCR(e)}return t<0n?W.newCR(W.recursivePow(this.crValue(),-t).inverse()):W.newCR(W.recursivePow(this.crValue(),t))}powN(t){if(1n===t)return this;if(0n===t)return W.ONE;let e=w(t);if(this.mCrFactor===W.CR_ONE&&e<=U){const e=this.mRatFactor.pow(t);if(null!==e)return W.newBR(e)}if(e>1000n)return this.expLnPow(t);let r=W.getSquare(this.mCrFactor);if(null!==r){const e=M.multiply(this.mRatFactor.pow(t),r.pow(t>>1n));if(null!==e)return 1n===(1n&t)?new W(e,this.mCrFactor):W.newBR(e)}return this.expLnPow(t)}pow(t){if(this.mCrFactor===W.CR_E){if(this.mRatFactor.equals(M.ONE))return t.exp();{let e=W.newBR(this.mRatFactor).pow(t);return t.exp().multiply(e)}}const e=t.boundedRationalValue();if(null!==e){let t=M.asBigInteger(e);if(null!==t)return this.powN(t);if(t=M.asBigInteger(M.multiply(M.TWO,e)),null!==t)return this.powN(t).sqrt()}if(this.definitelyZero())return W.ZERO;if(this.signumA(-1e3)<0)throw new f("Negative base for pow() with non-integer exponent");return W.newCR(this.crValue().ln().multiply(t.crValue()).exp())}static pow16(t){if(t>10)throw new _("Unexpected pow16 argument");let e=c(t);return e*=e,e*=e,e*=e,e*=e,e}static getIntLog(t,e){let n=h(t),i=s(n)/s(e);if(isFinite(n)&&r(i-u(i))>1e-6)return 0n;let a=0n,l=c(e),o=null;for(;t%l===0n;)for(t/=l,++a,null===o&&(o=W.pow16(e));t%o===0n;)t/=o,a+=16n;return 1n===t?a:0n}ln(){if(this.mCrFactor===W.CR_E)return new W(this.mRatFactor,W.CR_ONE).ln().add(W.ONE);if(this.isComparable(W.ZERO)){if(this.signum()<=0)throw new f("log(non-positive)");let t=this.compareToA(W.ONE,-1e3);if(0===t){if(this.definitelyEquals(W.ONE))return W.ZERO}else if(t<0)return this.inverse().ln().negate();const e=M.asBigInteger(this.mRatFactor);if(null!==e)if(this.mCrFactor===W.CR_ONE){const t=W.sLogs;for(let r=0;r<t.length;++r)if(null!==t[r]){let n=W.getIntLog(e,r);if(0n!==n)return new W(new M(n),t[r])}}else{let t=W.getSquare(this.mCrFactor);if(null!==t){let r=t.intValue();const n=W.sLogs;if(null!==n[r]){let t=W.getIntLog(e,r);if(0n!==t){let e=M.add(new M(t),M.HALF);if(null!==e)return new W(e,n[r])}}}}}return W.newCR(this.crValue().ln())}exp(){if(this.definitelyEquals(W.ZERO))return W.ONE;if(this.definitelyEquals(W.ONE))return W.E;const t=this.getExp(this.mCrFactor);if(null!==t){let e=!1,r=this.mRatFactor;null===M.asBigInteger(r)&&(e=!0,r=M.multiply(r,M.TWO));let n=M.pow(t,r);if(null!==n){let t=W.newBR(n);return e&&(t=t.sqrt()),t}}return W.newCR(this.crValue().exp())}static genFactorial(t,e){if(t>4n*e){return W.genFactorial(t,2n*e)*W.genFactorial(t-e,2n*e)}{if(0n===t)return 1n;let r=t;for(let n=t-e;n>1n;n-=e)r*=n;return r}}fact(){let t=this.bigIntegerValue();if(null===t&&(t=this.crValue().get_appr(0),!this.approxEquals(W.newN(t),-1e3)))throw new f("Non-integral factorial argument");if(t<0n)throw new f("Negative factorial argument");if(F(t)>20)throw new f("Factorial argument too big");let e=W.genFactorial(t,1n),r=new M(e);return W.newBR(r)}digitsRequired(){return this.mCrFactor===W.CR_ONE||0===this.mRatFactor.signum()?M.digitsRequired(this.mRatFactor):2147483647}leadingBinaryZeroes(){if(W.isNamed(this.mCrFactor)){const t=this.mRatFactor.wholeNumberBits();return-2147483648===t?2147483647:t>=3?0:3-t}return 2147483647}approxWholeNumberBitsGreaterThan(t){return W.isNamed(this.mCrFactor)?this.mRatFactor.wholeNumberBits()>t:F(this.crValue().get_appr(t-2))>2}}W.CR_ONE=E.ONE,W.CR_PI=E.PI,W.CR_E=E.ONE.exp(),W.CR_SQRT2=E.valueOfN(2n).sqrt(),W.CR_SQRT3=E.valueOfN(3n).sqrt(),W.CR_LN2=E.valueOfN(2n).ln(),W.CR_LN3=E.valueOfN(3n).ln(),W.CR_LN5=E.valueOfN(5n).ln(),W.CR_LN6=E.valueOfN(6n).ln(),W.CR_LN7=E.valueOfN(7n).ln(),W.CR_LN10=E.valueOfN(10n).ln(),W.sSqrts=Object.freeze([null,E.ONE,W.CR_SQRT2,W.CR_SQRT3,null,E.valueOfN(5n).sqrt(),E.valueOfN(6n).sqrt(),E.valueOfN(7n).sqrt(),null,null,E.valueOfN(10n).sqrt()]),W.sLogs=Object.freeze([null,null,W.CR_LN2,W.CR_LN3,null,W.CR_LN5,W.CR_LN6,W.CR_LN7,null,null,W.CR_LN10]),W.PI=W.newCR(W.CR_PI),W.E=W.newCR(W.CR_E),W.ZERO=W.newBR(M.ZERO),W.ONE=W.newBR(M.ONE),W.MINUS_ONE=W.newBR(M.MINUS_ONE),W.TWO=W.newBR(M.TWO),W.MINUS_TWO=W.newBR(M.MINUS_TWO),W.HALF=W.newBR(M.HALF),W.MINUS_HALF=W.newBR(M.MINUS_HALF),W.TEN=W.newBR(M.TEN),W.RADIANS_PER_DEGREE=new W(new M(1n,180n),W.CR_PI),W.SIX=W.newN(6n),W.HALF_SQRT2=new W(M.HALF,W.CR_SQRT2),W.SQRT3=W.newCR(W.CR_SQRT3),W.HALF_SQRT3=new W(M.HALF,W.CR_SQRT3),W.THIRD_SQRT3=new W(M.THIRD,W.CR_SQRT3),W.PI_OVER_2=new W(M.HALF,W.CR_PI),W.PI_OVER_3=new W(M.THIRD,W.CR_PI),W.PI_OVER_4=new W(M.QUARTER,W.CR_PI),W.PI_OVER_6=new W(M.SIXTH,W.CR_PI),W.EXTRA_PREC=10,W.EXTRA_PREC_BIG=10n;export{E as CR,M as BoundedRational,W as UnifiedReal,Q as UnaryCRFunction,k as UnaryCRFunctions};