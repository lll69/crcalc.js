/*
 * crcalc.js
 * Copyright 2025 lll69, Licensed under the Apache License, Version 2.0
 * Copyright (C) 2016 The Android Open Source Project, Licensed under the Apache License, Version 2.0
 * Copyright (C) 2015 The Android Open Source Project, Licensed under the Apache License, Version 2.0
 * Copyright (c) 1999, Silicon Graphics, Inc.
 * Copyright (c) 2001-2004, Hewlett-Packard Development Company, L.P.
 */
class t extends Error{constructor(t,e){super(t+(e?": "+e:e))}}class e extends t{constructor(t){super("PrecisionOverflowException",t)}}class n extends t{constructor(t){super("ArithmeticException",t)}}class r extends t{constructor(t){super("NumberFormatException",t)}}class i extends n{constructor(){super("Division by zero")}}class s extends t{constructor(t){super("AssertionError",t)}}function a(t){return t<0n?-t:t}function l(t,e){return t<e?-1:t===e?0:1}function u(t){return t<0n?-1:0n===t?0:1}function o(t){if(0n===t)return 0;t<0n&&(t=-1n-t);let e=0,n=t>>1048576n;for(;0n!==n;)e+=1048576,n=(t=n)>>1048576n;for(n=t>>1024n;0n!==n;)e+=1024,n=(t=n)>>1024n;for(n=t>>64n;0n!==n;)e+=64,n=(t=n)>>64n;let r,i=0n,s=64n;for(;i<s;)r=i+s+1n>>1n,t>>r===0n?s=r-1n:i=r;return e+Number(i)+1}function c(t,e){return 0n===e?t:e<0n?t>>-e:t<<e}function h(t,e){if(e>=0n)return t<<e;return c(t,e+1n)+1n>>1n}class m{constructor(){this.min_prec=0,this.appr_valid=!1}static bound_log2(t){let e=Math.abs(t);return 0^Math.ceil(Math.log(e+1)/Math.LN2)}static check_prec(t){if(t>>28^t>>29)throw new e}static valueOfN(t){return new f(t)}setMaxAppr(t){this.max_appr=t,this.maxApprBitLen=-1}getApprBitLen(){let t=this.maxApprBitLen;return-1===t&&(t=this.max_appr>=0n?o(this.max_appr):o(-this.max_appr),this.maxApprBitLen=t),t}get_appr(t){if(m.check_prec(t),this.appr_valid&&t>=this.min_prec)return h(this.max_appr,BigInt(this.min_prec-t));{let e=this.approximate(t);return this.min_prec=t,this.setMaxAppr(e),this.appr_valid=!0,e}}known_msd(){let t=this.getApprBitLen();return this.min_prec+t-1}msd(t){return(!this.appr_valid||this.max_appr<=1n&&this.max_appr>=-1n)&&(this.get_appr(t-1),a(this.max_appr)<=1n)?-2147483648:this.known_msd()}iter_msd(t){let e,n=0;for(;n>t+30;n=(3*n>>1)-16){if(e=this.msd(n),-2147483648!==e)return e;m.check_prec(n)}return this.msd(t)}msd_get(){return this.iter_msd(-2147483648)}static zeroes(t){let e="";for(let n=0;n<t;++n)e+="0";return e}simple_ln(){return new E(this.subtract(m.ONE))}static atan_reciprocal(t){return new O(t)}compareToRA(t,e,n){let r=this.iter_msd(n),i=t.iter_msd(r>n?r:n),s=i>r?i:r;if(-2147483648===s)return 0;m.check_prec(e);let a=s+e,l=a>n?a:n;return this.compareToA(t,l)}compareToA(t,e){let n=e-1,r=this.get_appr(n),i=t.get_appr(n);return l(r,i+1n)>0?1:l(r,i-1n)<0?-1:0}compareTo(t){for(let e=-20;;e*=2){m.check_prec(e);let n=this.compareToA(t,e);if(0!==n)return n}}signumA(t){if(this.appr_valid){let t=u(this.max_appr);if(0!==t)return t}let e=t-1;return u(this.get_appr(e))}signum(){for(let t=-20;;t*=2){m.check_prec(t);let e=this.signumA(t);if(0!==e)return e}}static valueOfS(t,e){if(void 0===e&&(e=10),2!==e&&8!==e&&10!==e&&16!==e)throw new r("Radix: "+e);let n,i,s=t.length,a=0;for(;" "===t.charAt(a);)++a;for(;" "===t.charAt(s-1);)--s;n=t.indexOf(".",a),-1===n?(n=s,i=""):i=t.substring(n+1,s);let l,u=t.substring(a,n);switch(e){case 2:l=BigInt("0b"+u+i);break;case 8:l=BigInt("0o"+u+i);break;case 10:l=BigInt(u+i);break;case 16:l=BigInt("0x"+u+i)}let o=BigInt(e)**BigInt(i.length);return m.valueOfN(l).divide(m.valueOfN(o))}toStringR(t,e){let n;if(16===e)n=this.shiftLeft(4*t);else{let r=BigInt(e)**BigInt(t);n=this.multiply(new f(r))}let r,i=n.get_appr(0),s=a(i).toString(e);if(0===t)r=s;else{let e=s.length;if(e<=t){s=m.zeroes(t+1-e)+s,e=t+1}r=s.substring(0,e-t)+"."+s.substring(e-t)}return i<0n&&(r="-"+r),r}toStringD(t){return this.toStringR(t,10)}toString(){return this.toStringD(10)}BigIntegerValue(){return this.get_appr(0)}doubleValue(){let t=this.iter_msd(-1080);if(-2147483648===t)return 0;let e=t-60,n=Number(this.get_appr(e)),r=e<-1e3,i=new ArrayBuffer(8),s=new DataView(i);s.setFloat64(0,n);let a=s.getBigInt64(0),l=BigInt(r?e+96:e);if((a>>52n&0x7ffn)+l>=2047)return n<0?-1/0:1/0;a+=l<<52n,s.setBigInt64(0,a);let u=s.getFloat64(0);if(r){const t=Number(1n<<48n);return u/t/t}return u}add(t){return new R(this,t)}shiftLeft(t){return m.check_prec(t),new _(this,t)}shiftRight(t){return m.check_prec(t),new _(this,-t)}assumeInt(){return new g(this)}negate(){return new w(this)}subtract(t){return new R(this,t.negate())}multiply(t){return new N(this,t)}inverse(){return new F(this)}divide(t){return new N(this,t.inverse())}select(t,e){return new d(this,t,e)}max(t){return this.subtract(t).select(t,this)}min(t){return this.subtract(t).select(this,t)}abs(){return this.select(this.negate(),this)}exp(){let t=this.get_appr(-10);if(t>2n||t<-2n){let t=this.shiftRight(1).exp();return t.multiply(t)}return new C(this)}cos(){let t=this.divide(m.PI).get_appr(-1);if(a(t)>=2n){let e=h(t,-1n),n=m.PI.multiply(m.valueOfN(e));return 0n!==(1n&e)?this.subtract(n).cos().negate():this.subtract(n).cos()}if(a(this.get_appr(-1))>=2n){let t=this.shiftRight(1).cos();return t.multiply(t).shiftLeft(1).subtract(m.ONE)}return new I(this)}sin(){return m.half_pi.subtract(this).cos()}asin(){let t=this.get_appr(-10);if(t>750n){return m.ONE.subtract(this.multiply(this)).sqrt().acos()}return t<-750n?this.negate().asin().negate():new B(this)}acos(){return m.half_pi.subtract(this.asin())}ln(){let t=this.get_appr(-4);if(t<0n)throw new n("ln(negative)");if(t<=8n)return this.inverse().ln().negate();if(t>=24n){if(t<=64n){return this.sqrt().sqrt().ln().shiftLeft(2)}{let e=o(t)-3;return this.shiftRight(e).ln().add(m.valueOfN(BigInt(e)).multiply(m.ln2))}}return this.simple_ln()}sqrt(){return new v(this)}}class p extends m{get_appr(t){if(p.check_prec(t),this.appr_valid&&t>=this.min_prec)return h(this.max_appr,BigInt(this.min_prec-t));{let e=t>=-64?-64:t-32+1&-32,n=this.approximate(e);return this.min_prec=e,this.setMaxAppr(n),this.appr_valid=!0,h(n,BigInt(e-t))}}}class f extends m{constructor(t){super(),this.value=t}approximate(t){return h(this.value,BigInt(-t))}}class g extends m{constructor(t){super(),this.value=t}approximate(t){return t>=0?this.value.get_appr(t):h(this.value.get_appr(0),BigInt(-t))}}class R extends m{constructor(t,e){super(),this.op1=t,this.op2=e}approximate(t){return h(this.op1.get_appr(t-2)+this.op2.get_appr(t-2),-2n)}}class _ extends m{constructor(t,e){super(),this.op=t,this.count=e}approximate(t){return this.op.get_appr(t-this.count)}}class w extends m{constructor(t){super(),this.op=t}approximate(t){return-this.op.get_appr(t)}}class d extends m{constructor(t,e,n){super(),this.selector=t,this.selector_sign=u(t.get_appr(-20)),this.op1=e,this.op2=n}approximate(t){if(this.selector_sign<0)return this.op1.get_appr(t);if(this.selector_sign>0)return this.op2.get_appr(t);let e=this.op1.get_appr(t-1),n=this.op2.get_appr(t-1);return a(e-n)<=1n?h(e,-1n):this.selector.signum()<0?(this.selector_sign=-1,h(e,-1n)):(this.selector_sign=1,h(n,-1n))}}class N extends m{constructor(t,e){super(),this.op1=t,this.op2=e}approximate(t){let e,n=(t>>1)-1,r=this.op1.msd(n);if(-2147483648===r){if(e=this.op2.msd(n),-2147483648===e)return 0n;{let t;t=this.op1,this.op1=this.op2,this.op2=t,r=e}}let i=t-r-3,s=this.op2.get_appr(i);if(0n===s)return 0n;e=this.op2.known_msd();let a=t-e-3;return h(this.op1.get_appr(a)*s,BigInt(a+i-t))}}class F extends m{constructor(t){super(),this.op=t}approximate(t){let e=this.op.msd_get(),n=e-(1-e-t+3),r=-t-n;if(r<0)return 0n;let i=1n<<BigInt(r),s=this.op.get_appr(n),l=a(s),u=(i+(l>>1n))/l;return s<0?-u:u}}class C extends m{constructor(t){super(),this.op=t}approximate(t){if(t>=1)return 0n;let e=2+(-t>>1),n=t-C.bound_log2(2*e)-4,r=t-3,i=this.op.get_appr(r),s=BigInt(r),l=1n<<BigInt(-n),u=l,o=l,c=0,m=1n<<BigInt(t-4-n);for(;a(u)>=m;)c=c+1^0,u=h(u*i,s),u/=BigInt(c),o+=u;return h(o,BigInt(n-t))}}class I extends p{constructor(t){super(),this.op=t}approximate(t){if(t>=1)return 0n;let e,n,r=4+(-t>>1),i=t-I.bound_log2(2*r)-4,s=t-2,l=this.op.get_appr(s),u=BigInt(s),o=1n<<BigInt(t-4-i);n=0,e=1n<<BigInt(-i);let c=e;for(;a(e)>=o;){n+=2,e=h(e*l,u),e=h(e*l,u),e/=BigInt(-n)*BigInt(n-1),c+=e}return h(c,BigInt(i-t))}}class O extends p{constructor(t){super(),this.op=t}approximate(t){if(t>=1)return 0n;let e=2+(-t>>1),n=t-O.bound_log2(2*e)-2,r=1n<<BigInt(-n),i=BigInt(this.op),s=BigInt(this.op*this.op),l=r/i,u=l,o=l,c=l,m=1,p=1,f=1n<<BigInt(t-2-n);for(;a(o)>=f;)p+=2,u/=s,m=-m,o=u/BigInt(m*p),c+=o;return h(c,BigInt(n-t))}}class E extends p{constructor(t){super(),this.op=t}approximate(t){if(t>=0)return 0n;let e=-t,n=t-E.bound_log2(2*e)-4,r=t-3,i=this.op.get_appr(r),s=BigInt(r),l=h(i,BigInt(r-n)),u=l,o=u,c=1,m=1,p=1n<<BigInt(t-4-n);for(;a(u)>=p;)c+=1,m=-m,l=h(l*i,s),u=l/BigInt(c*m),o+=u;return h(o,BigInt(n-t))}}class B extends p{constructor(t){super(),this.op=t}approximate(t){if(t>=2)return 0n;let e=-3*(t>>1)+4,n=t-B.bound_log2(2*e)-4,r=t-3,i=this.op.get_appr(r),s=BigInt(r+2),l=BigInt(r-2),u=1n<<BigInt(t-4-n),o=1,c=i<<BigInt(r-n),m=c,p=c;for(;a(c)>=u;){o+=2,p*=BigInt(o-2),p=h(p*i,s),p*=i,p/=BigInt(o-1),p=h(p,l),c=p/BigInt(o),m+=c}return h(m,BigInt(n-t))}}class v extends m{constructor(t,e=0,n=null){super(),this.op=t,this.min_prec=e,null!==n&&(this.setMaxAppr(n),this.appr_valid=!0)}approximate(t){let e=(t<<1)-1,r=this.op.iter_msd(e);if(r<=e)return 0n;let i=r>>1,s=i-t;if(s>50){let e=i-(6+(s>>1)),n=e<<1,r=this.op.get_appr(n),a=this.get_appr(e);return h(a*a+r,BigInt(e-t))/a+1n>>1n}{let e=r-60&-2,i=e-60,s=this.op.get_appr(e)<<60n,a=Number(s);if(a<0)throw new n("sqrt(negative)");let l=Math.sqrt(a);return c(BigInt(Math.floor(l)),BigInt((i>>1)-t))}}}class b extends p{constructor(){super(),this.b_prec=[null],this.b_val=[null]}approximate(t){if(this.b_prec.length>this.b_val.length&&this.b_prec.pop(),t>=0)return h(3n,BigInt(-t));const e=Math.ceil(Math.log(-t)/Math.LN2)+10^0,n=BigInt(-e),r=t-e,i=BigInt(-r);let s=1n<<i,a=b.SQRT_HALF.get_appr(r),l=1n<<BigInt(-r-2),u=0;for(;s-a-4n>0n;){let e,o=s+a>>1n,c=s-o,m=s*a>>i,p=b.valueOfN(m).shiftRight(-r);if(this.b_prec.length===u+1){e=p.sqrt().get_appr(r);let i=h(e,n);this.b_prec.push(t),this.b_val.push(i)}else{e=new v(p,this.b_prec[u+1],this.b_val[u+1]).get_appr(r),this.b_prec[u+1]=t,this.b_val[u+1]=h(e,n)}s=o,a=e,l=l-(c*c<<BigInt(u+r)),++u}let o=s+a;return h(o*o/l>>2n,n)}}m.ZERO=m.valueOfN(0n),m.ONE=m.valueOfN(1n),m.ten_ninths=m.valueOfN(10n).divide(m.valueOfN(9n)),m.twentyfive_twentyfourths=m.valueOfN(25n).divide(m.valueOfN(24n)),m.eightyone_eightyeths=m.valueOfN(81n).divide(m.valueOfN(80n)),m.ln2_1=m.valueOfN(7n).multiply(m.ten_ninths.simple_ln()),m.ln2_2=m.valueOfN(2n).multiply(m.twentyfive_twentyfourths.simple_ln()),m.ln2_3=m.valueOfN(3n).multiply(m.eightyone_eightyeths.simple_ln()),m.ln2=m.ln2_1.subtract(m.ln2_2).add(m.ln2_3),m.SQRT_HALF=new v(m.ONE.shiftRight(1)),m.four=m.valueOfN(4n),m.PI=new b,m.atan_PI=m.four.multiply(m.four.multiply(m.atan_reciprocal(5)).subtract(m.atan_reciprocal(239))),m.half_pi=m.PI.shiftRight(1);class x{}const y=Object.freeze({sinFunction:new class extends x{execute(t){return t.sin()}},cosFunction:new class extends x{execute(t){return t.cos()}},tanFunction:new class extends x{execute(t){return t.sin().divide(t.cos())}},asinFunction:new class extends x{execute(t){return t.asin()}},acosFunction:new class extends x{execute(t){return t.acos()}},atanFunction:new class extends x{constructor(){super(...arguments),this.one=m.ONE}execute(t){let e=t.multiply(t),n=e.divide(this.one.add(e)).sqrt();return t.select(n.negate(),n).asin()}}});class T{constructor(t,e=1n){this.mNum=t,this.mDen=e}static valueOfS(t,e){if(void 0===e&&(e=10),2!==e&&8!==e&&10!==e&&16!==e)throw new r("Radix: "+e);let n,i,s=t.length,a=0;for(;" "===t.charAt(a);)++a;for(;" "===t.charAt(s-1);)--s;n=t.indexOf(".",a),-1===n?(n=s,i=""):i=t.substring(n+1,s);let l,u=t.substring(a,n);switch(e){case 2:l=BigInt("0b"+u+i);break;case 8:l=BigInt("0o"+u+i);break;case 10:l=BigInt(u+i);break;case 16:l=BigInt("0x"+u+i)}let o=BigInt(e)**BigInt(i.length);return new T(l,o)}toString(){return this.mNum.toString()+"/"+this.mDen.toString()}toNiceString(){let t=this.reduce().positiveDen(),e=t.mNum.toString();return 1n!==t.mDen&&(e+="/"+t.mDen),e}static toString(t){return null===t?"not a small rational":t.toString()}toStringTruncated(t){let e=(a(this.mNum)*10n**BigInt(t)/a(this.mDen)).toString(),n=e.length;return n<t+1&&(e="0".repeat(t+1-n)+e,n=t+1),(this.signum()<0?"-":"")+e.substring(0,n-t)+"."+e.substring(n-t)}crValue(){return m.valueOfN(this.mNum).divide(m.valueOfN(this.mDen))}intValue(){let t=this.reduce();if(1n!==t.mDen)throw new n("intValue of non-int");return Number(t.mNum)}wholeNumberBits(){return 0n===this.mNum?-2147483648:o(this.mNum)-o(this.mDen)}tooBig(){return 1n!==this.mDen&&o(this.mNum)+o(this.mDen)>1e4}positiveDen(){return this.mDen>0n?this:new T(-this.mNum,-this.mDen)}reduce(){if(1n===this.mDen)return this;let t=function(t,e){let n;for(t=t<0n?-t:t,e=e<0n?-e:e;0n!==e;)n=e,e=t%e,t=n;return t}(this.mNum,this.mDen);return new T(this.mNum/t,this.mDen/t)}static maybeReduce(t){if(null===t)return null;if(!t.tooBig()&&Math.random()<1/16)return t;let e=t.positiveDen();return e=e.reduce(),e.tooBig()?null:e}compareTo(t){return l(this.mNum*t.mDen,t.mNum*this.mDen)*u(this.mDen)*u(t.mDen)}signum(){return u(this.mNum)*u(this.mDen)}equals(t){return null!==t&&0===this.compareTo(t)}static asBigInteger(t){return null===t?null:t.mNum%t.mDen===0n?t.mNum/t.mDen:null}static add(t,e){if(null===t||null===e)return null;let n=t.mDen*e.mDen,r=t.mNum*e.mDen+e.mNum*t.mDen;return T.maybeReduce(new T(r,n))}static negate(t){return null===t?null:new T(-t.mNum,t.mDen)}static subtract(t,e){return T.add(t,T.negate(e))}static rawMultiply(t,e){if(null===t||null===e)return null;if(t===T.ONE)return e;if(e===T.ONE)return t;let n=t.mNum*e.mNum,r=t.mDen*e.mDen;return new T(n,r)}static multiply(t,e){return T.maybeReduce(T.rawMultiply(t,e))}static inverse(t){if(null===t)return null;if(0n===t.mNum)throw new i;return new T(t.mDen,t.mNum)}static divide(t,e){return T.multiply(t,T.inverse(e))}static sqrt(t){if(null===t)return null;if((t=t.positiveDen().reduce()).mNum<0n)throw new n("sqrt(negative)");let e=Math.round(Math.sqrt(Number(t.mNum)));if(e===1/0)return null;let r=BigInt(e);if(r*r!==t.mNum)return null;let i=Math.round(Math.sqrt(Number(t.mDen)));if(i===1/0)return null;let s=BigInt(i);return s*s!==t.mDen?null:new T(r,s)}rawPow(t){if(1n===t)return this;if(1n===(1n&t))return T.rawMultiply(this.rawPow(t-1n),this);if(0n===t)return T.ONE;let e=this.rawPow(t>>1n),n=T.rawMultiply(e,e);return null===n||n.tooBig()?null:n}pow(t){let e=u(t);if(0===e)return T.ONE;if(1n===t)return this;let n=this.reduce().positiveDen();if(1n===n.mDen){if(0n===n.mNum)return T.ZERO;if(1n===n.mNum)return T.ONE;if(-1n===n.mNum)return 1n===(1n&t)?T.MINUS_ONE:T.ONE}return o(t)>1e3?null:e<0?T.inverse(n).rawPow(-t):n.rawPow(t)}static pow(t,e){return null===e||null===t||1n!==(e=e.reduce().positiveDen()).mDen?null:t.pow(e.mNum)}static digitsRequired(t){if(null===t)return 2147483647;let e=0,n=0;if(1n===t.mDen)return 0;let r=(t=t.reduce()).mDen;if(o(r)>1e4)return 2147483647;for(;0n===(1n&r);)++e,r>>=1n;for(;r%5n===0n;)++n,r/=5n;return 1n!==r&&-1n!==r?1e4:Math.max(e,n)}}T.ZERO=new T(0n),T.HALF=new T(1n,2n),T.MINUS_HALF=new T(-1n,2n),T.THIRD=new T(1n,3n),T.QUARTER=new T(1n,4n),T.SIXTH=new T(1n,6n),T.ONE=new T(1n),T.MINUS_ONE=new T(-1n),T.TWO=new T(2n),T.MINUS_TWO=new T(-2n),T.TEN=new T(10n),T.TWELVE=new T(12n);const S=1n<<1000n;class A{static check(t){if(!t)throw new s}constructor(t,e){if(null===t)throw new n("Building UnifiedReal from null");this.mCrFactor=e,this.mRatFactor=t}static newCR(t){return new A(T.ONE,t)}static newBR(t){return new A(t,A.CR_ONE)}static newN(t){return A.newBR(new T(t))}static getSquare(t){const e=A.sSqrts;for(let n=0;n<e.length;++n)if(e[n]===t)return new T(BigInt(n));return null}getExp(t){const e=A.sLogs;for(let n=0;n<e.length;++n)if(e[n]===t)return new T(BigInt(n));return null}static crName(t){if(t===A.CR_ONE)return"";if(t===A.CR_PI)return"π";if(t===A.CR_E)return"e";const e=A.sSqrts;for(let n=0;n<e.length;++n)if(t===e[n])return"√"+n;const n=A.sLogs;for(let e=0;e<n.length;++e)if(t===n[e])return"ln("+e+")";return null}static isNamed(t){if(t===A.CR_ONE||t===A.CR_PI||t===A.CR_E)return!0;const e=A.sSqrts;for(let n=0;n<e.length;++n)if(t===e[n])return!0;const n=A.sLogs;for(let e=0;e<n.length;++e)if(t===n[e])return!0;return!1}static definitelyAlgebraic(t){return t===A.CR_ONE||null!==A.getSquare(t)}definitelyRational(){return this.mCrFactor===A.CR_ONE||0===this.mRatFactor.signum()}definitelyIrrational(){return!this.definitelyRational()&&A.isNamed(this.mCrFactor)}definitelyAlgebraic(){return A.definitelyAlgebraic(this.mCrFactor)||0===this.mRatFactor.signum()}definitelyTranscendental(){return!this.definitelyAlgebraic()&&A.isNamed(this.mCrFactor)}static definitelyIndependent(t,e){return t!==e&&(t===A.CR_E||t===A.CR_PI?A.definitelyAlgebraic(e):e===A.CR_E||e===A.CR_PI?A.definitelyAlgebraic(t):A.isNamed(t)&&A.isNamed(e))}toString(){return this.mRatFactor.toString()+"*"+this.mCrFactor.toString()}toNiceString(){if(this.mCrFactor===A.CR_ONE||0===this.mRatFactor.signum())return this.mRatFactor.toNiceString();let t=A.crName(this.mCrFactor);if(null!==t){let e=T.asBigInteger(this.mRatFactor);return null!==e?1n===e?t:this.mRatFactor.toNiceString()+t:"("+this.mRatFactor.toNiceString()+")"+t}return this.mRatFactor===T.ONE?this.mCrFactor.toString():this.crValue().toString()}exactlyDisplayable(){return null!==A.crName(this.mCrFactor)}toStringTruncated(t){if(this.mCrFactor===A.CR_ONE||this.mRatFactor===T.ZERO)return this.mRatFactor.toStringTruncated(t);const e=m.valueOfN(10n**BigInt(t)).multiply(this.crValue());let n,r=!1;this.exactlyTruncatable()?(n=e.get_appr(0),n<0n&&(r=!0,n=-n),m.valueOfN(n).compareTo(e.abs())>0&&(n-=1n),A.check(m.valueOfN(n).compareTo(e.abs())<0)):(n=e.get_appr(-A.EXTRA_PREC),n<0n&&(r=!0,n=-n),n>>=A.EXTRA_PREC_BIG);let i=n.toString(),s=i.length;return s<t+1&&(i="0".repeat(t+1-s)+i,s=t+1),(r?"-":"")+i.substring(0,s-t)+"."+i.substring(s-t)}exactlyTruncatable(){return this.mCrFactor===A.CR_ONE||this.mRatFactor===T.ZERO||this.definitelyIrrational()}crValue(){return this.mRatFactor.crValue().multiply(this.mCrFactor)}isComparable(t){return this.mCrFactor===t.mCrFactor&&(A.isNamed(this.mCrFactor)||0!==this.mCrFactor.signumA(-1e3))||0===this.mRatFactor.signum()&&0===t.mRatFactor.signum()||A.definitelyIndependent(this.mCrFactor,t.mCrFactor)||0!==this.crValue().compareToA(t.crValue(),-1e3)}compareTo(t){if(this.definitelyZero()&&t.definitelyZero())return 0;if(this.mCrFactor===t.mCrFactor){return this.mCrFactor.signum()*this.mRatFactor.compareTo(t.mRatFactor)}return this.crValue().compareTo(t.crValue())}compareToA(t,e){return this.isComparable(t)?this.compareTo(t):this.crValue().compareToA(t.crValue(),e)}signumA(t){return this.compareToA(A.ZERO,t)}signum(){return this.compareTo(A.ZERO)}approxEquals(t,e){return this.isComparable(t)?(!A.definitelyIndependent(this.mCrFactor,t.mCrFactor)||0===this.mRatFactor.signum()&&0===t.mRatFactor.signum())&&0===this.compareTo(t):0===this.crValue().compareToA(t.crValue(),e)}definitelyEquals(t){return this.isComparable(t)&&0===this.compareTo(t)}definitelyNotEquals(t){let e=A.isNamed(this.mCrFactor),n=A.isNamed(t.mCrFactor);return e&&n?A.definitelyIndependent(this.mCrFactor,t.mCrFactor)?0!==this.mRatFactor.signum()||0!==t.mRatFactor.signum():(this.mCrFactor,t.mCrFactor,!this.mRatFactor.equals(t.mRatFactor)):0===this.mRatFactor.signum()?n&&0!==t.mRatFactor.signum():0===t.mRatFactor.signum()&&(e&&0!==this.mRatFactor.signum())}definitelyZero(){return 0===this.mRatFactor.signum()}definitelyNonZero(){return A.isNamed(this.mCrFactor)&&0!==this.mRatFactor.signum()}definitelyOne(){return this.mCrFactor===A.CR_ONE&&this.mRatFactor.equals(T.ONE)}boundedRationalValue(){return this.mCrFactor===A.CR_ONE||0===this.mRatFactor.signum()?this.mRatFactor:null}bigIntegerValue(){let t=this.boundedRationalValue();return T.asBigInteger(t)}add(t){if(this.mCrFactor===t.mCrFactor){let e=T.add(this.mRatFactor,t.mRatFactor);if(null!==e)return new A(e,this.mCrFactor)}return this.definitelyZero()?t:t.definitelyZero()?this:A.newCR(this.crValue().add(t.crValue()))}negate(){return new A(T.negate(this.mRatFactor),this.mCrFactor)}subtract(t){return this.add(t.negate())}multiply(t){if(this.mCrFactor===A.CR_ONE){let e=T.multiply(this.mRatFactor,t.mRatFactor);if(null!==e)return new A(e,t.mCrFactor)}if(t.mCrFactor===A.CR_ONE){let e=T.multiply(this.mRatFactor,t.mRatFactor);if(null!==e)return new A(e,this.mCrFactor)}if(this.definitelyZero()||t.definitelyZero())return A.ZERO;if(this.mCrFactor===t.mCrFactor){let e=A.getSquare(this.mCrFactor);if(null!==e){let n=T.multiply(T.multiply(e,this.mRatFactor),t.mRatFactor);if(null!==n)return A.newBR(n)}}let e=T.multiply(this.mRatFactor,t.mRatFactor);return null!==e?new A(e,this.mCrFactor.multiply(t.mCrFactor)):A.newCR(this.crValue().multiply(t.crValue()))}inverse(){if(this.definitelyZero())throw new i;let t=A.getSquare(this.mCrFactor);if(null!==t){let e=T.inverse(T.multiply(this.mRatFactor,t));if(null!==e)return new A(e,this.mCrFactor)}return new A(T.inverse(this.mRatFactor),this.mCrFactor.inverse())}divide(t){if(this.mCrFactor===t.mCrFactor){if(t.definitelyZero())throw new i;let e=T.divide(this.mRatFactor,t.mRatFactor);if(null!==e)return new A(e,A.CR_ONE)}return this.multiply(t.inverse())}sqrt(){if(this.definitelyZero())return A.ZERO;if(this.mCrFactor===A.CR_ONE){let t;for(let e=1;e<A.sSqrts.length;++e)if(null!==A.sSqrts[e]&&(t=T.sqrt(T.divide(this.mRatFactor,new T(BigInt(e)))),null!==t))return new A(t,A.sSqrts[e])}return A.newCR(this.crValue().sqrt())}getPiTwelfths(){if(this.definitelyZero())return 0n;if(this.mCrFactor===A.CR_PI){let t=T.asBigInteger(T.multiply(this.mRatFactor,T.TWELVE));return null===t?null:t%24n}return null}static sinPiTwelfths(t){if(t>=12){let e=A.sinPiTwelfths(t-12);return null===e?null:e.negate()}switch(t){case 0:return A.ZERO;case 2:case 10:return A.HALF;case 3:case 9:return A.HALF_SQRT2;case 4:case 8:return A.HALF_SQRT3;case 6:return A.ONE;default:return null}}sin(){let t=this.getPiTwelfths();if(null!==t){let e=A.sinPiTwelfths(Number(t));if(null!==e)return e}return A.newCR(this.crValue().sin())}static cosPiTwelfths(t){let e=t+6;return e>=24&&(e-=24),A.sinPiTwelfths(e)}cos(){let t=this.getPiTwelfths();if(null!==t){let e=A.cosPiTwelfths(Number(t));if(null!==e)return e}return A.newCR(this.crValue().cos())}tan(){let t=this.getPiTwelfths();if(null!==t){let e=Number(t);if(6===e||18===e)throw new n("Tangent undefined");let r=A.sinPiTwelfths(e),i=A.cosPiTwelfths(e);if(null!==r&&null!==i)return r.divide(i)}return this.sin().divide(this.cos())}checkAsinDomain(){if(this.isComparable(A.ONE)&&(this.compareTo(A.ONE)>0||this.compareTo(A.MINUS_ONE)<0))throw new n("inverse trig argument out of range")}static asinHalves(t){if(t<0)return this.asinHalves(-t).negate();switch(t){case 0:return A.ZERO;case 1:return new A(T.SIXTH,m.PI);case 2:return new A(T.HALF,m.PI)}throw new s("asinHalves: Bad argument")}asinNonHalves(){return this.compareToA(A.ZERO,-10)<0?this.negate().asinNonHalves().negate():this.definitelyEquals(A.HALF_SQRT2)?new A(T.QUARTER,A.CR_PI):this.definitelyEquals(A.HALF_SQRT3)?new A(T.THIRD,A.CR_PI):A.newCR(this.crValue().asin())}asin(){this.checkAsinDomain();const t=this.multiply(A.TWO).bigIntegerValue();return null!==t?A.asinHalves(Number(t)):this.mCrFactor===m.ONE||this.mCrFactor!==A.CR_SQRT2||this.mCrFactor!==A.CR_SQRT3?this.asinNonHalves():A.newCR(this.crValue().asin())}acos(){return A.PI_OVER_2.subtract(this.asin())}atan(){if(this.compareToA(A.ZERO,-10)<0)return this.negate().atan().negate();const t=this.bigIntegerValue();if(null!==t&&t<=1n){switch(Number(t)){case 0:return A.ZERO;case 1:return A.PI_OVER_4;default:throw new s("Impossible r_int")}}return this.definitelyEquals(A.THIRD_SQRT3)?A.PI_OVER_6:this.definitelyEquals(A.SQRT3)?A.PI_OVER_3:A.newCR(y.atanFunction.execute(this.crValue()))}static recursivePow(t,e){if(1n===e)return t;if(0n!==(1n&e))return t.multiply(A.recursivePow(t,e-1n));let n=A.recursivePow(t,e>>1n);return n.multiply(n)}expLnPow(t){let e=this.signumA(-1e3);if(e>0)return A.newCR(this.crValue().ln().multiply(m.valueOfN(t)).exp());if(e<0){let e=this.crValue().negate().ln().multiply(m.valueOfN(t)).exp();return 0n!==(1n&t)&&(e=e.negate()),A.newCR(e)}return t<0n?A.newCR(A.recursivePow(this.crValue(),-t).inverse()):A.newCR(A.recursivePow(this.crValue(),t))}powN(t){if(1n===t)return this;if(0n===t)return A.ONE;let e=a(t);if(this.mCrFactor===A.CR_ONE&&e<=S){const e=this.mRatFactor.pow(t);if(null!==e)return A.newBR(e)}if(e>1000n)return this.expLnPow(t);let n=A.getSquare(this.mCrFactor);if(null!==n){const e=T.multiply(this.mRatFactor.pow(t),n.pow(t>>1n));if(null!==e)return 1n===(1n&t)?new A(e,this.mCrFactor):A.newBR(e)}return this.expLnPow(t)}pow(t){if(this.mCrFactor===A.CR_E){if(this.mRatFactor.equals(T.ONE))return t.exp();{let e=A.newBR(this.mRatFactor).pow(t);return t.exp().multiply(e)}}const e=t.boundedRationalValue();if(null!==e){let t=T.asBigInteger(e);if(null!==t)return this.powN(t);if(t=T.asBigInteger(T.multiply(T.TWO,e)),null!==t)return this.powN(t).sqrt()}if(this.definitelyZero())return A.ZERO;if(this.signumA(-1e3)<0)throw new n("Negative base for pow() with non-integer exponent");return A.newCR(this.crValue().ln().multiply(t.crValue()).exp())}static pow16(t){if(t>10)throw new s("Unexpected pow16 argument");let e=BigInt(t);return e*=e,e*=e,e*=e,e*=e,e}static getIntLog(t,e){let n=Number(t),r=Math.log(n)/Math.log(e);if(isFinite(n)&&Math.abs(r-Math.round(r))>1e-6)return 0n;let i=0n,s=BigInt(e),a=null;for(;t%s===0n;)for(t/=s,++i,null===a&&(a=A.pow16(e));t%a===0n;)t/=a,i+=16n;return 1n===t?i:0n}ln(){if(this.mCrFactor===A.CR_E)return new A(this.mRatFactor,A.CR_ONE).ln().add(A.ONE);if(this.isComparable(A.ZERO)){if(this.signum()<=0)throw new n("log(non-positive)");let t=this.compareToA(A.ONE,-1e3);if(0===t){if(this.definitelyEquals(A.ONE))return A.ZERO}else if(t<0)return this.inverse().ln().negate();const e=T.asBigInteger(this.mRatFactor);if(null!==e)if(this.mCrFactor===A.CR_ONE){const t=A.sLogs;for(let n=0;n<t.length;++n)if(null!==t[n]){let r=A.getIntLog(e,n);if(0n!==r)return new A(new T(r),t[n])}}else{let t=A.getSquare(this.mCrFactor);if(null!==t){let n=t.intValue();const r=A.sLogs;if(null!==r[n]){let t=A.getIntLog(e,n);if(0n!==t){let e=T.add(new T(t),T.HALF);if(null!==e)return new A(e,r[n])}}}}}return A.newCR(this.crValue().ln())}exp(){if(this.definitelyEquals(A.ZERO))return A.ONE;if(this.definitelyEquals(A.ONE))return A.E;const t=this.getExp(this.mCrFactor);if(null!==t){let e=!1,n=this.mRatFactor;null===T.asBigInteger(n)&&(e=!0,n=T.multiply(n,T.TWO));let r=T.pow(t,n);if(null!==r){let t=A.newBR(r);return e&&(t=t.sqrt()),t}}return A.newCR(this.crValue().exp())}static genFactorial(t,e){if(t>4n*e){return A.genFactorial(t,2n*e)*A.genFactorial(t-e,2n*e)}{if(0n===t)return 1n;let n=t;for(let r=t-e;r>1n;r-=e)n*=r;return n}}fact(){let t=this.bigIntegerValue();if(null===t&&(t=this.crValue().get_appr(0),!this.approxEquals(A.newN(t),-1e3)))throw new n("Non-integral factorial argument");if(t<0n)throw new n("Negative factorial argument");if(o(t)>20)throw new n("Factorial argument too big");let e=A.genFactorial(t,1n),r=new T(e);return A.newBR(r)}digitsRequired(){return this.mCrFactor===A.CR_ONE||0===this.mRatFactor.signum()?T.digitsRequired(this.mRatFactor):2147483647}leadingBinaryZeroes(){if(A.isNamed(this.mCrFactor)){const t=this.mRatFactor.wholeNumberBits();return-2147483648===t?2147483647:t>=3?0:3-t}return 2147483647}approxWholeNumberBitsGreaterThan(t){return A.isNamed(this.mCrFactor)?this.mRatFactor.wholeNumberBits()>t:o(this.crValue().get_appr(t-2))>2}}A.CR_ONE=m.ONE,A.CR_PI=m.PI,A.CR_E=m.ONE.exp(),A.CR_SQRT2=m.valueOfN(2n).sqrt(),A.CR_SQRT3=m.valueOfN(3n).sqrt(),A.CR_LN2=m.valueOfN(2n).ln(),A.CR_LN3=m.valueOfN(3n).ln(),A.CR_LN5=m.valueOfN(5n).ln(),A.CR_LN6=m.valueOfN(6n).ln(),A.CR_LN7=m.valueOfN(7n).ln(),A.CR_LN10=m.valueOfN(10n).ln(),A.sSqrts=Object.freeze([null,m.ONE,A.CR_SQRT2,A.CR_SQRT3,null,m.valueOfN(5n).sqrt(),m.valueOfN(6n).sqrt(),m.valueOfN(7n).sqrt(),null,null,m.valueOfN(10n).sqrt()]),A.sLogs=Object.freeze([null,null,A.CR_LN2,A.CR_LN3,null,A.CR_LN5,A.CR_LN6,A.CR_LN7,null,null,A.CR_LN10]),A.PI=A.newCR(A.CR_PI),A.E=A.newCR(A.CR_E),A.ZERO=A.newBR(T.ZERO),A.ONE=A.newBR(T.ONE),A.MINUS_ONE=A.newBR(T.MINUS_ONE),A.TWO=A.newBR(T.TWO),A.MINUS_TWO=A.newBR(T.MINUS_TWO),A.HALF=A.newBR(T.HALF),A.MINUS_HALF=A.newBR(T.MINUS_HALF),A.TEN=A.newBR(T.TEN),A.RADIANS_PER_DEGREE=new A(new T(1n,180n),A.CR_PI),A.SIX=A.newN(6n),A.HALF_SQRT2=new A(T.HALF,A.CR_SQRT2),A.SQRT3=A.newCR(A.CR_SQRT3),A.HALF_SQRT3=new A(T.HALF,A.CR_SQRT3),A.THIRD_SQRT3=new A(T.THIRD,A.CR_SQRT3),A.PI_OVER_2=new A(T.HALF,A.CR_PI),A.PI_OVER_3=new A(T.THIRD,A.CR_PI),A.PI_OVER_4=new A(T.QUARTER,A.CR_PI),A.PI_OVER_6=new A(T.SIXTH,A.CR_PI),A.EXTRA_PREC=10,A.EXTRA_PREC_BIG=10n,"undefined"!=typeof module&&(module.exports={CR:m,BoundedRational:T,UnifiedReal:A,UnaryCRFunction:x,UnaryCRFunctions:y}),void 0!==this&&Object.assign(this,{CR:m,BoundedRational:T,UnifiedReal:A,UnaryCRFunction:x,UnaryCRFunctions:y});