(()=>{"use strict";const e=2147483647;let t=25,n=0,i=!1,r=!1,o=!1,s=!1;const c="*",a=document,l=Math,d=a.getElementById.bind(a),u=a.createTextNode.bind(a),f=l.min,h=l.max,p=l.abs,v=l.floor,g=l.round,m=setInterval,b=clearInterval,E=setTimeout,x=clearTimeout,_=URL.createObjectURL,L="".replaceAll?(e,t,n)=>e.replaceAll(t,n):(e,t,n)=>e.split(t).join(n),k=d("calculator"),y=d("expression"),C=d("result_div"),S=d("result_bold"),w=d("result_normal"),T=d("toggle_inv"),D=d("but_eq"),O=d("toggle_mode"),A=d("measure_4ch"),B=[d("num_0"),d("num_1"),d("num_2"),d("num_3"),d("num_4"),d("num_5"),d("num_6"),d("num_7"),d("num_8"),d("num_9")],R=[d("fun_ln"),d("fun_log")],N=[d("fun_exp"),d("fun_10pow")],j=[d("fun_sin"),d("fun_cos"),d("fun_tan")],U=[d("fun_asin"),d("fun_acos"),d("fun_atan")],M=[d("react_sinh_root"),d("react_cosh_root"),d("react_tanh_root")],P=[d("react_asinh_root"),d("react_acosh_root"),d("react_atanh_root")],z=d("copy_result"),W=d("save_result"),I=d("show_simplify"),X=d("react_simplify_root"),q=d("grid_ops"),F=d("grid_var"),H=d("loading"),K=u("Loading..."),Y=u("");S.innerHTML="",S.appendChild(K),w.appendChild(Y);let G,V,J=null,Q=!1,Z=!1,$=!1,ee=!1,te=!1,ne=!1,ie=!1,re=null,oe={},se="",ce=e,ae=32,le=-1,de=-1,ue=0,fe=1,he=1,pe=0;function ve(e,t,n){let i=!1;if(oe.showAlert)try{oe.showAlert(e,t),i=!0}catch(e){console.error(e)}i||alert(n())}function ge(e){let t=a.createElement("input");t.style.opacity="0",t.value=e,a.body.appendChild(t),t.select(),a.execCommand("copy"),t.remove()}function me(){z.hidden=!ee,W.hidden=!ee,I.hidden=!(!s&&ee&&ne),X.hidden=!(s&&ee&&ne)}function be(n){if(!Q||!ee)return;const i=se.endsWith(".")?se.length-1:se.length,r=ce!==e&&i<=t;if(ie=!r,r)return n?void n(!0,0===ce?se.substring(0,se.length-1):se):(ue=0,0===ce?(K.textContent=se.substring(0,se.length-1),Y.textContent=""):(K.textContent=se,Y.textContent=""),void C.classList.remove("result-movable"));-1===de&&(de=se.indexOf("."),-1===de&&(de=se.length));let o=ue+t;if(o>i&&(0===ce?ue=f(ue,de-t):ce!==e&&(ue=f(ue,ce+4>=t?de+1+ce-t+String(ce).length+2:de+1+ce-t)),o=ue+t),ue<0&&(ue=0),C.classList.contains("result-movable")||C.classList.add("result-movable"),o<=de){let i,r,s,c,a;if(o=f(ue+t,se.length),o!==de||0!==ce)for(i=de-o,r=String(i).length+1,s=i+r,c=String(s),a=c.length+1;a>r;)r=a,s=i+r,c=String(s),a=c.length+1;else c="",a=0;if(0===ue){let i=!1;if(a>0&&de>t){let r="-"===se[0]?de-2:de-1,s=String(r).length+1;if(s<t-3){let t;if(t="-"===se[0]?se.substring(0,2)+"."+se.substring(2,o-s-1)+"E"+r:se[0]+"."+se.substring(1,o-s-1)+"E"+r,n)return void(ce===e?n(!1,t):n(!0,0===ce?se.substring(0,se.length-1):se));K.textContent=t,Y.textContent="",i=!0}}if(!i){if(n)return void(ce===e?n(!1,se.substring(0,o-a)+"E"+c):n(!0,0===ce?se.substring(0,se.length-1):se));K.textContent=se.substring(ue,o-a),Y.textContent=a>0?"E"+c:""}}else{if(n)return void(ce===e?n(!1,se.substring(0,o-a)+"E"+c):n(!0,0===ce?se.substring(0,se.length-1):se));K.textContent="..."+se.substring(ue+3,o-a),Y.textContent=a>0?"E"+c:""}}else if(0===ue||ue+4<=de){if(o=f(ue+t,se.length),n)return void(ce===e?n(!1,se.substring(0,o)):n(!0,0===ce?se.substring(0,se.length-1):se));K.textContent=0===ue?se.substring(ue,o):"..."+se.substring(ue+3,o),Y.textContent=""}else{let e=o-de-1,r=String(e).length+2,s=e-r,c=String(s),a=c.length+2;for(;a<r;)r=a,s=e-r,c=String(s),a=c.length+2;if(a>r&&(s-=1,c=String(s),a=c.length+3),ue>i-t+a){if(n)return void n(!1,se);K.textContent="Calculating...",ae=h(ue-de+2*a,le+128*f(1024,1+v(ue/1600))),Se()}else{if(n)return void n(!1,se.substring(0,o-a));K.textContent="..."+se.substring(ue+3,o-a)}if(Y.textContent="E-"+c,ue>i-t+a-64){let e=i;ae=le;const n=128*f(1024,1+v(ue/1600));for(;ue>e-t+a-64;)ae+=n,e+=n;ae=f(ce,ae),Se()}}}function Ee(t){const i=t.data;switch(i.type){case"init":if(!Q){Q=!0;for(let e=0,t=a.getElementsByClassName("intro");e<t.length;e++)t[e].hidden=!0;d("loading-style").remove(),ke(),Te(),navigator.userAgent.indexOf("Firefox")>=0&&(H.innerText="When performing exponentiation and factorial calculations, Chrome/Edge may be faster than Firefox and can compute more digits.",H.hidden=!1)}break;case"createUR":if(i.success)ee=!0,ne=i.exactlyDisplayable,te=!1,ce=i.digitsRequired,ae=ce!==e?160:32,le=-1,de=-1,Z=!1,Se();else{ee=!1,te=!0,Z=!1,x(V),D.innerText="=",C.classList.remove("result-movable"),K.textContent=i.error,Y.textContent="";let e=String(i.error),t=e.match(/at position \[(\d+),(\d+)\]/);if(t){Te();let e=Number(t[1]);y.selectionStart=e,y.selectionEnd=Number(t[2]),y.scrollLeft=n*(e>0?e-1:e)}if(t=e.match(/at position \((\d+)\)/),t){Te();let e=Number(t[1]);y.selectionStart=e,y.selectionEnd=e+1,y.scrollLeft=n*(e>0?e-1:e)}!function(e){e.startsWith("Error: ArithmeticException: ")&&(C.scrollLeft=28*n)}(e),me()}break;case"toStringTruncated":if(i.uid===he)if(Z=!1,x(V),D.innerText="=",i.error)ee=!1,te=!0,C.classList.remove("result-movable"),K.textContent=i.error,Y.textContent="",me();else{ee=!0,te=!1;let e=i.result;i.prec>=le&&(le=i.prec,se=e,be(),me()),ae>le&&Se()}break;case"toNiceString":if(i.uid===he){const e=i.error||i.result;ve("Simplified Result",e,(()=>"Simplified Result: "+e))}}}function xe(e){console.error(e),H.innerText="Worker Error: "+e.message,H.hidden=!1}function _e(){re&&re.terminate(),re=new Worker(_(new Blob([J],{type:"text/javascript"}))),re.onmessage=Ee,re.onerror=xe,Z=!1,ee=!1,te=!1}function Le(e){b(G),H.innerText=e,y.readOnly=!0,y.value=e,C.classList.remove("result-movable"),K.textContent="Try refreshing the page.",Y.textContent="",Array.prototype.forEach.call(k.getElementsByTagName("button"),(e=>{e.disabled=!0}))}function ke(){C.classList.remove("result-movable"),K.textContent="",Y.textContent="",H.hidden=!0,$=!1,ee=!1,te=!1,se="",ce=e,ae=32,le=-1,de=-1,ue=0,me()}function ye(){Z&&(_e(),D.innerText="="),ke()}function Ce(){if(Z){const e="The calculation took longer than expected.\nValue may be infinite or undefined (such as tan(90°) or 1/0), or the number may have too many digits.\nYou can stop the calculation or wait for it to complete. Waiting may result in prolonged high CPU usage.";ve("Calculation timed out",e,(()=>e))}}function Se(){if(!Q||!ee||Z)return;let e=f(ce,ae);e<=le||(Z=!0,D.innerText="STOP",re.postMessage({type:"toStringTruncated",id:fe,uid:++he,prec:e}))}function we(){if(Q){if(Z)return _e(),void(D.innerText="=");ke(),qe(),function(){let e=y.value,t=!1;e.indexOf(" ")>=0&&(e=L(e," ",""),t=!0),e.indexOf("pi")>=0&&(e=L(e,"pi","π"),t=!0),e.indexOf("**")>=0&&(e=L(e,"**","^"),t=!0),e.indexOf("×")>=0&&(e=L(e,"×","*"),t=!0),e.indexOf("÷")>=0&&(e=L(e,"÷","/"),t=!0),t&&(y.value=e,y.selectionStart=y.selectionEnd=e.length)}(),$=!0,D.innerText="STOP",re.postMessage({type:"removeUR",id:fe}),fe=fe+1|0,me(),re.postMessage({type:"createUR",id:fe,uid:fe,expr:y.value,degreeMode:i}),Z=!0,V=E(Ce,5e3)}}function Te(){Q&&y.focus()}function De(){T.title=r?"Hide inverse functions":"Show inverse functions"}function Oe(){for(const e of R)r?e.classList.add("op-hide"):e.classList.remove("op-hide");for(const e of N)r?e.classList.remove("op-hide"):e.classList.add("op-hide");for(const e of j)r||o?e.classList.add("op-hide"):e.classList.remove("op-hide");for(const e of U)r&&!o?e.classList.remove("op-hide"):e.classList.add("op-hide");for(const e of M)o&&!r?e.classList.remove("op-hide"):e.classList.add("op-hide");for(const e of P)o&&r?e.classList.remove("op-hide"):e.classList.add("op-hide")}function Ae(){O.title=i?"Currently in degree mode":"Currently in radian mode",O.innerText=i?"DEG":"RAD"}function Be(e){if(!Q)return;const t=y.value,n=y.selectionStart,i=y.selectionEnd;n===i&&n===t.length?y.value=t+e:y.value=t.substring(0,n)+e+t.substring(i,t.length),y.selectionStart=y.selectionEnd=n+e.length,ye()}function Re(){ee&&$&&($=!1,y.value="",y.selectionStart=0,y.selectionEnd=0)}function Ne(e,t){if(!Q)return;Re();const n=y.value,i=y.selectionStart;if(i>0){const t=n[i-1];if(")!πxyze".indexOf(t)>=0)return Be(c+e),!0}t||Be(String(e))}function je(e){if(!Q)return!0;Re();const t=y.value,n=y.selectionStart,i=y.selectionEnd;if(i<t.length){let e=i;for(;e<t.length;){const n=t[e];if("0123456789".indexOf(n)<0){if("."===n)return!0;break}e++}}if(n>0){const e=t[n-1];if(")!πxyze".indexOf(e)>=0)return Be("*0."),!0;if("+-×÷*/^(".indexOf(e)>=0)return Be("0."),!0;{let e=n;for(;e>=0;){e--;const n=t[e];if("0123456789".indexOf(n)<0){if("."===n)return!0;break}}}}if(n<=0)return Be("0."),!0;e||Be(".")}function Ue(e,t){if(Q){if("("===e){const e=y.value,t=y.selectionStart,n=y.selectionEnd;let i=!1;if(t>0){const n=e[t-1];"0123456789.)!πxyze".indexOf(n)>=0&&(i=!0)}if(t!==n)return i?(y.value=e.substring(0,t)+c+"("+e.substring(t,n)+")"+e.substring(n,e.length),y.selectionStart=t+2,y.selectionEnd=n+2):(y.value=e.substring(0,t)+"("+e.substring(t,n)+")"+e.substring(n,e.length),y.selectionStart=t+1,y.selectionEnd=n+1),ye(),!0;if(i)return Be("*("),!0}t||Be(e)}}function Me(e,t){if(!Q)return;if("!"===e)return t||Be(e),!1;const n=y.value,i=y.selectionStart;if(i>0){const t=n[i-1];if("-"===e){if("+"===t)y.selectionStart=i-1;else if("-×÷*/^".indexOf(t)>=0)return Be("("+e),!0}else{if("*"===e&&"*"===t)return y.selectionStart=i-1,Be("^"),!0;if(i>0&&"+-×÷*/^".indexOf(t)>=0)return y.selectionStart=i-1,Be(e),!0}}t||Be(e)}function Pe(e){if(!Q)return;Re();const t=y.value,n=y.selectionStart;if(n>0){const i=t.charAt(n-1);if("0123456789.)!πxyze".indexOf(i)>=0)return void Be(c+e)}Be(e)}function ze(e){if(!Q)return;Re();const t=y.value,n=y.selectionStart;if(n>0){const i=t.charAt(n-1);if("0123456789.)!πxyze".indexOf(i)>=0)return void Be(c+e+"(")}Be(e+"(")}function We(e){d("fun_"+e).addEventListener("click",(()=>{ze(e),Te()}))}function Ie(e){if(!Q)return;if(e)return!1;const t=y.selectionStart,n=y.selectionEnd;if(t===n){if(t>0){const e=y.value;y.value=e.substring(0,t-1)+e.substring(n,e.length),y.selectionStart=y.selectionEnd=t-1,ye()}}else Be("")}G=m((function(){pe=(pe+1)%4,K.textContent="Loading..."+"/-\\|"[pe]}),100),fetch("calc_worker.js").then((e=>{e.ok?e.text().then((e=>{b(G),function(e){J=e,_e()}(e)})).catch((e=>{console.error(e),Le("Error: calc_worker.js "+e)})):Le("Error: calc_worker.js status="+e.status)})).catch((e=>{console.error(e),Le("Error: calc_worker.js "+e)})),De(),T.addEventListener("click",(function(){Q&&(r=!r,Oe(),De(),Te())})),Ae(),O.addEventListener("click",(function(){Q&&(i=!i,Ae(),ee&&ke(),Te())})),B.forEach(((e,t)=>{e.addEventListener("click",(()=>{Ne(t),Te()}))})),d("num_point").addEventListener("click",(()=>{je(),Te()})),d("op_add").addEventListener("click",(()=>{Me("+"),Te()})),d("op_sub").addEventListener("click",(()=>{Me("-"),Te()})),d("op_mul").addEventListener("click",(()=>{Me(c),Te()})),d("op_div").addEventListener("click",(()=>{Me("/"),Te()})),d("op_pow").addEventListener("click",(()=>{Me("^"),Te()})),d("op_fact").addEventListener("click",(()=>{Me("!"),Te()})),d("const_pi").addEventListener("click",(()=>{Pe("π"),Te()})),d("const_e").addEventListener("click",(()=>{Pe("e"),Te()})),d("op_lparen").addEventListener("click",(()=>{Ue("("),Te()})),d("op_rparen").addEventListener("click",(()=>{Ue(")"),Te()})),d("op_sqrt").addEventListener("click",(()=>{ze("sqrt"),Te()})),We("sin"),We("cos"),We("tan"),We("asin"),We("acos"),We("atan"),We("ln"),We("log"),We("exp"),d("fun_10pow").addEventListener("click",(()=>{Be("10^"),Te()})),d("fun_percent").addEventListener("click",(()=>{Be("/100"),Te()})),d("op_cbrt").addEventListener("click",(()=>{Be("^(1/3)"),Te()})),d("but_del").addEventListener("click",(()=>{Ie(),Te()})),d("but_clr").addEventListener("click",(()=>{Q&&(Z&&(_e(),D.innerText="="),y.value="",ke()),Te()})),oe.onSinhButtonClick=()=>{ze("sinh"),Te()},oe.onCoshButtonClick=()=>{ze("cosh"),Te()},oe.onTanhButtonClick=()=>{ze("tanh"),Te()},oe.onASinhButtonClick=()=>{ze("asinh"),Te()},oe.onACoshButtonClick=()=>{ze("acosh"),Te()},oe.onATanhButtonClick=()=>{ze("atanh"),Te()},oe.onHypButtonClick=function(){Q&&(o=!o,Oe(),De(),Te())},D.addEventListener("click",we),y.addEventListener("input",ye),y.addEventListener("keydown",(e=>{if(!Q)return void e.preventDefault();const t=e.key;switch(t){case"Backspace":Ie(!0)&&e.preventDefault();break;case"Enter":case"=":e.preventDefault(),we();break;case"(":case")":Ue(t,!0)&&e.preventDefault();break;case".":je(!0)&&e.preventDefault();break;case"+":case"-":Me(t,!0)&&e.preventDefault();break;case"*":Me(c,!0)&&e.preventDefault();break;case"/":Me("/",!0)&&e.preventDefault();break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":Ne(Number(t),!0)&&e.preventDefault()}})),z.addEventListener("click",(()=>{const t=e=>{ve("Copied",e,(()=>e))};0===ce&&0===le?(ge(se.substring(0,se.length-1)),t("Exact result has been copied (length:"+(se.length-1)+")")):ce!==e&&le>=ce?(ge(se),t("Exact result has been copied (length:"+se.length+")")):be(((n,i)=>{ge(i),t(n&&(0===ce||ce!==e&&le>=ce)?"Exact result has been copied (length:"+i.length+")":"TRUNCATED result has been copied (length:"+i.length+")")}))})),W.addEventListener("click",(()=>{let t;if(0===ce&&0===le?t=se.substring(0,se.length-1):ce!==e&&le>=ce&&(t=se),t){let e=_(new Blob([t],{type:"text/plain"})),n=a.createElement("a");n.href=e,n.download="output_exact.txt",a.body.appendChild(n),n.click(),n.remove()}else be(((t,n)=>{let i=_(new Blob([n],{type:"text/plain"})),r=a.createElement("a");r.href=i,r.download=t&&(0===ce||ce!==e&&le>=ce)?"output_exact.txt":"output_truncated.txt",a.body.appendChild(r),r.click(),r.remove()}))})),I.addEventListener("click",(()=>{ee&&ne&&re.postMessage({type:"toNiceString",id:fe,uid:++he})}));{let e=d("but_var");e.disabled=!0,e.innerText=""}function Xe(e){d("var_in_"+e).addEventListener("click",(()=>{})),d("var_out_"+e).addEventListener("click",(()=>{}))}function qe(){n=A.getBoundingClientRect().width/4;let e=v(k.clientWidth/n);e!==t&&(t=e,ee&&be())}d("but_var").addEventListener("click",(()=>{})),d("var_close").addEventListener("click",(()=>{Q&&(q.classList.remove("grid-hide"),F.classList.add("grid-hide"),Te())})),Xe("x"),Xe("y"),Xe("z"),function(e){let t=0,n=!1;e.addEventListener("scroll",(()=>{let i=t;t=e.scrollLeft,0!==e.scrollLeft||n||0===i||(e.scrollLeft=i)})),e.addEventListener("focus",(()=>{n=!0,e===y&&($=!1)})),e.addEventListener("blur",(()=>{n=!1}))}(y),y.addEventListener("pointerdown",(()=>{$=!1})),new ResizeObserver(qe).observe(k),qe(),function(){let e=!1,i="",r=0,o=0,s=0,c=0,a=0,l=-1;function d(){let e=p(a);2*e>n&&e!==1/0?a*=.8333333333333334:b(l),r+=a;let t=g(r/n),i=h(0,s-t);i!==ue&&(ue=i,be())}function u(t){Q&&ee&&ie&&(t.preventDefault(),"touchstart"===t.type?r=t.touches[0].screenX:e||(r=t.screenX,C.setPointerCapture(t.pointerId)),i=t.type,b(l),o=r,s=ue,c=t.timeStamp,a=0,e=!0,C.focus({preventScroll:!0}))}function f(t){if(e){let e,l;if(t.preventDefault(),"touchmove"===t.type&&"touchstart"===i)e=t.touches[0].screenX;else{if("pointermove"!==t.type||"pointerdown"!==i)return;e=t.screenX}l=e-r;let d=g(l/n),u=t.timeStamp-c;u>=40&&(c=t.timeStamp,a=40*(e-o)/u,o=e);let f=h(0,s-d);f!==ue&&(ue=f,be())}}function v(t){if(e){if("pointerup"===t.type&&"pointerdown"===i)C.releasePointerCapture(t.pointerId);else if("touchstart"!==i||"touchend"!==t.type&&"touchcancel"!==t.type)return;t.preventDefault(),e=!1,r=0,s=ue,p(a)>n&&(l=m(d,40))}}const E={passive:!1};C.addEventListener("touchstart",u,E),C.addEventListener("pointerdown",u,E),C.addEventListener("touchmove",f,E),C.addEventListener("pointermove",f,E),C.addEventListener("touchend",v,E),C.addEventListener("pointerup",v,E),C.addEventListener("touchcancel",v,E),C.addEventListener("wheel",(e=>{if(Q&&ee&&ie){b(l),e.preventDefault();let t=e.deltaX+e.deltaY,i=g(t/n),r=h(0,ue+i);r!==ue&&(ue=r,be())}})),C.addEventListener("keydown",(e=>{let n;switch(e.key){case"ArrowLeft":case"ArrowUp":e.preventDefault(),n=h(0,ue-(e.ctrlKey?1:4)),n!==ue&&(ue=n,be());break;case"ArrowRight":case"ArrowDown":e.preventDefault(),n=h(0,ue+(e.ctrlKey?1:4)),n!==ue&&(ue=n,be());break;case"PageDown":e.preventDefault(),n=h(0,ue+t),n!==ue&&(ue=n,be());break;case"PageUp":e.preventDefault(),n=h(0,ue-t),n!==ue&&(ue=n,be())}}))}(),window.calcMuiPlugin=oe,fetch("calc_mui.js").then((e=>{e.ok?e.text().then((e=>{Function(e)()})).catch((e=>{console.error(e)})):console.error("Error: calc_mui.js status="+e.status)})).catch((e=>{console.error(e)})),addEventListener("message",(e=>{"hypRendered"===e.data?(d("fun_percent").classList.add("op-hide"),d("react_hyp_root").classList.remove("op-hide")):"simplifyRendered"===e.data&&(s=!0,me())}))})();