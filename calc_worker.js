/*! For license information please see calc_worker.js.LICENSE.txt */
(()=>{"use strict";class t extends Error{constructor(t,e){super(t+(e?": "+e:e))}}class e extends t{constructor(t){super("PrecisionOverflowException",t)}}class n extends t{constructor(t){super("ArithmeticException",t)}}class r extends t{constructor(t){super("NumberFormatException",t)}}class i extends n{constructor(){super("Division by zero")}}class s extends t{constructor(t){super("AssertionError",t)}}function a(t){return t<0n?-t:t}function u(t,e){return t<e?-1:t===e?0:1}function l(t){return t<0n?-1:0n===t?0:1}function o(t){if(0n===t)return 0;t<0n&&(t=-1n-t);let e=0,n=t>>1048576n;for(;0n!==n;)e+=1048576,n=(t=n)>>1048576n;for(n=t>>1024n;0n!==n;)e+=1024,n=(t=n)>>1024n;for(n=t>>64n;0n!==n;)e+=64,n=(t=n)>>64n;let r,i=0n,s=64n;for(;i<s;)r=i+s+1n>>1n,t>>r===0n?s=r-1n:i=r;return e+Number(i)+1}function h(t,e){return 0n===e?t:e<0n?t>>-e:t<<e}function c(t,e){return e>=0n?t<<e:h(t,e+1n)+1n>>1n}class p{constructor(){this.min_prec=0,this.appr_valid=!1}static bound_log2(t){let e=Math.abs(t);return 0^Math.ceil(Math.log(e+1)/Math.LN2)}static check_prec(t){if(t>>28^t>>29)throw new e}static valueOfN(t){return new f(t)}setMaxAppr(t){this.max_appr=t,this.maxApprBitLen=-1}getApprBitLen(){let t=this.maxApprBitLen;return-1===t&&(t=this.max_appr>=0n?o(this.max_appr):o(-this.max_appr),this.maxApprBitLen=t),t}get_appr(t){if(p.check_prec(t),this.appr_valid&&t>=this.min_prec)return c(this.max_appr,BigInt(this.min_prec-t));{let e=this.approximate(t);return this.min_prec=t,this.setMaxAppr(e),this.appr_valid=!0,e}}known_msd(){let t=this.getApprBitLen();return this.min_prec+t-1}msd(t){return(!this.appr_valid||this.max_appr<=1n&&this.max_appr>=-1n)&&(this.get_appr(t-1),a(this.max_appr)<=1n)?-2147483648:this.known_msd()}iter_msd(t){let e,n=0;for(;n>t+30;n=(3*n>>1)-16){if(e=this.msd(n),-2147483648!==e)return e;p.check_prec(n)}return this.msd(t)}msd_get(){return this.iter_msd(-2147483648)}static zeroes(t){let e="";for(let n=0;n<t;++n)e+="0";return e}simple_ln(){return new v(this.subtract(p.ONE))}static atan_reciprocal(t){return new F(t)}compareToRA(t,e,n){let r=this.iter_msd(n),i=t.iter_msd(r>n?r:n),s=i>r?i:r;if(-2147483648===s)return 0;p.check_prec(e);let a=s+e,u=a>n?a:n;return this.compareToA(t,u)}compareToA(t,e){let n=e-1,r=this.get_appr(n),i=t.get_appr(n);return u(r,i+1n)>0?1:u(r,i-1n)<0?-1:0}compareTo(t){for(let e=-20;;e*=2){p.check_prec(e);let n=this.compareToA(t,e);if(0!==n)return n}}signumA(t){if(this.appr_valid){let t=l(this.max_appr);if(0!==t)return t}let e=t-1;return l(this.get_appr(e))}signum(){for(let t=-20;;t*=2){p.check_prec(t);let e=this.signumA(t);if(0!==e)return e}}static valueOfS(t,e){if(void 0===e&&(e=10),2!==e&&8!==e&&10!==e&&16!==e)throw new r("Radix: "+e);let n,i,s=t.length,a=0;for(;" "===t.charAt(a);)++a;for(;" "===t.charAt(s-1);)--s;n=t.indexOf(".",a),-1===n?(n=s,i=""):i=t.substring(n+1,s);let u,l=t.substring(a,n);switch(e){case 2:u=BigInt("0b"+l+i);break;case 8:u=BigInt("0o"+l+i);break;case 10:u=BigInt(l+i);break;case 16:u=BigInt("0x"+l+i)}let o=BigInt(e)**BigInt(i.length);return p.valueOfN(u).divide(p.valueOfN(o))}toStringR(t,e){let n;if(16===e)n=this.shiftLeft(4*t);else{let r=BigInt(e)**BigInt(t);n=this.multiply(new f(r))}let r,i=n.get_appr(0),s=a(i).toString(e);if(0===t)r=s;else{let e=s.length;e<=t&&(s=p.zeroes(t+1-e)+s,e=t+1),r=s.substring(0,e-t)+"."+s.substring(e-t)}return i<0n&&(r="-"+r),r}toStringD(t){return this.toStringR(t,10)}toString(){return this.toStringD(10)}BigIntegerValue(){return this.get_appr(0)}doubleValue(){let t=this.iter_msd(-1080);if(-2147483648===t)return 0;let e=t-60,n=Number(this.get_appr(e)),r=e<-1e3,i=new ArrayBuffer(8),s=new DataView(i);s.setFloat64(0,n);let a=s.getBigInt64(0),u=BigInt(r?e+96:e);if((a>>52n&0x7ffn)+u>=2047)return n<0?-1/0:1/0;a+=u<<52n,s.setBigInt64(0,a);let l=s.getFloat64(0);if(r){const t=Number(1n<<48n);return l/t/t}return l}add(t){return new w(this,t)}shiftLeft(t){return p.check_prec(t),new d(this,t)}shiftRight(t){return p.check_prec(t),new d(this,-t)}assumeInt(){return new g(this)}negate(){return new R(this)}subtract(t){return new w(this,t.negate())}multiply(t){return new N(this,t)}inverse(){return new I(this)}divide(t){return new N(this,t.inverse())}select(t,e){return new _(this,t,e)}max(t){return this.subtract(t).select(t,this)}min(t){return this.subtract(t).select(this,t)}abs(){return this.select(this.negate(),this)}exp(){let t=this.get_appr(-10);if(t>2n||t<-2n){let t=this.shiftRight(1).exp();return t.multiply(t)}return new C(this)}cos(){let t=this.divide(p.PI).get_appr(-1);if(a(t)>=2n){let e=c(t,-1n),n=p.PI.multiply(p.valueOfN(e));return 0n!==(1n&e)?this.subtract(n).cos().negate():this.subtract(n).cos()}if(a(this.get_appr(-1))>=2n){let t=this.shiftRight(1).cos();return t.multiply(t).shiftLeft(1).subtract(p.ONE)}return new E(this)}sin(){return p.half_pi.subtract(this).cos()}asin(){let t=this.get_appr(-10);return t>750n?p.ONE.subtract(this.multiply(this)).sqrt().acos():t<-750n?this.negate().asin().negate():new y(this)}acos(){return p.half_pi.subtract(this.asin())}ln(){let t=this.get_appr(-4);if(t<0n)throw new n("ln(negative)");if(t<=8n)return this.inverse().ln().negate();if(t>=24n){if(t<=64n)return this.sqrt().sqrt().ln().shiftLeft(2);{let e=o(t)-3;return this.shiftRight(e).ln().add(p.valueOfN(BigInt(e)).multiply(p.ln2))}}return this.simple_ln()}sqrt(){return new O(this)}}class m extends p{get_appr(t){if(m.check_prec(t),this.appr_valid&&t>=this.min_prec)return c(this.max_appr,BigInt(this.min_prec-t));{let e=t>=-64?-64:t-32+1&-32,n=this.approximate(e);return this.min_prec=e,this.setMaxAppr(n),this.appr_valid=!0,c(n,BigInt(e-t))}}}class f extends p{constructor(t){super(),this.value=t}approximate(t){return c(this.value,BigInt(-t))}}class g extends p{constructor(t){super(),this.value=t}approximate(t){return t>=0?this.value.get_appr(t):c(this.value.get_appr(0),BigInt(-t))}}class w extends p{constructor(t,e){super(),this.op1=t,this.op2=e}approximate(t){return c(this.op1.get_appr(t-2)+this.op2.get_appr(t-2),-2n)}}class d extends p{constructor(t,e){super(),this.op=t,this.count=e}approximate(t){return this.op.get_appr(t-this.count)}}class R extends p{constructor(t){super(),this.op=t}approximate(t){return-this.op.get_appr(t)}negate(){return this.op}}class _ extends p{constructor(t,e,n){super(),this.selector=t,this.selector_sign=l(t.get_appr(-20)),this.op1=e,this.op2=n}approximate(t){if(this.selector_sign<0)return this.op1.get_appr(t);if(this.selector_sign>0)return this.op2.get_appr(t);let e=this.op1.get_appr(t-1),n=this.op2.get_appr(t-1);return a(e-n)<=1n?c(e,-1n):this.selector.signum()<0?(this.selector_sign=-1,c(e,-1n)):(this.selector_sign=1,c(n,-1n))}}class N extends p{constructor(t,e){super(),this.op1=t,this.op2=e}approximate(t){let e,n=(t>>1)-1,r=this.op1.msd(n);if(-2147483648===r){if(e=this.op2.msd(n),-2147483648===e)return 0n;{let t;t=this.op1,this.op1=this.op2,this.op2=t,r=e}}let i=t-r-3,s=this.op2.get_appr(i);if(0n===s)return 0n;e=this.op2.known_msd();let a=t-e-3;return c(this.op1.get_appr(a)*s,BigInt(a+i-t))}}class I extends p{constructor(t){super(),this.op=t}approximate(t){let e=this.op.msd_get(),n=e-(1-e-t+3),r=-t-n;if(r<0)return 0n;let i=1n<<BigInt(r),s=this.op.get_appr(n),u=a(s),l=(i+(u>>1n))/u;return s<0?-l:l}}class C extends p{constructor(t){super(),this.op=t}approximate(t){if(t>=1)return 0n;let e=2+(-t>>1),n=t-C.bound_log2(2*e)-4,r=t-3,i=this.op.get_appr(r),s=BigInt(r),u=1n<<BigInt(-n),l=u,o=u,h=0,p=1n<<BigInt(t-4-n);for(;a(l)>=p;)h=h+1^0,l=c(l*i,s),l/=BigInt(h),o+=l;return c(o,BigInt(n-t))}}class E extends m{constructor(t){super(),this.op=t}approximate(t){if(t>=1)return 0n;let e,n,r=4+(-t>>1),i=t-E.bound_log2(2*r)-4,s=t-2,u=this.op.get_appr(s),l=BigInt(s),o=1n<<BigInt(t-4-i);n=0,e=1n<<BigInt(-i);let h=e;for(;a(e)>=o;)n+=2,e=c(e*u,l),e=c(e*u,l),e/=BigInt(-n)*BigInt(n-1),h+=e;return c(h,BigInt(i-t))}}class F extends m{constructor(t){super(),this.op=t}approximate(t){if(t>=1)return 0n;let e=2+(-t>>1),n=t-F.bound_log2(2*e)-2,r=1n<<BigInt(-n),i=BigInt(this.op),s=BigInt(this.op*this.op),u=r/i,l=u,o=u,h=u,p=1,m=1,f=1n<<BigInt(t-2-n);for(;a(o)>=f;)m+=2,l/=s,p=-p,o=l/BigInt(p*m),h+=o;return c(h,BigInt(n-t))}}class v extends m{constructor(t){super(),this.op=t}approximate(t){if(t>=0)return 0n;let e=-t,n=t-v.bound_log2(2*e)-4,r=t-3,i=this.op.get_appr(r),s=BigInt(r),u=c(i,BigInt(r-n)),l=u,o=l,h=1,p=1,m=1n<<BigInt(t-4-n);for(;a(l)>=m;)h+=1,p=-p,u=c(u*i,s),l=u/BigInt(h*p),o+=l;return c(o,BigInt(n-t))}}class y extends m{constructor(t){super(),this.op=t}approximate(t){if(t>=2)return 0n;let e=-3*(t>>1)+4,n=t-y.bound_log2(2*e)-4,r=t-3,i=this.op.get_appr(r),s=BigInt(r+2),u=BigInt(r-2),l=1n<<BigInt(t-4-n),o=1,h=i<<BigInt(r-n),p=h,m=h;for(;a(h)>=l;)o+=2,m*=BigInt(o-2),m=c(m*i,s),m*=i,m/=BigInt(o-1),m=c(m,u),h=m/BigInt(o),p+=h;return c(p,BigInt(n-t))}}class O extends p{constructor(t,e=0,n=null){super(),this.op=t,this.min_prec=e,null!==n&&(this.setMaxAppr(n),this.appr_valid=!0)}approximate(t){let e=(t<<1)-1,r=this.op.iter_msd(e);if(r<=e)return 0n;let i=r>>1,s=i-t;if(s>50){let e=i-(6+(s>>1)),n=e<<1,r=this.op.get_appr(n),a=this.get_appr(e);return c(a*a+r,BigInt(e-t))/a+1n>>1n}{let e=r-60&-2,i=e-60,s=this.op.get_appr(e)<<60n,a=Number(s);if(a<0)throw new n("sqrt(negative)");let u=Math.sqrt(a);return h(BigInt(Math.floor(u)),BigInt((i>>1)-t))}}}class b extends m{constructor(){super(),this.b_prec=[null],this.b_val=[null]}approximate(t){if(this.b_prec.length>this.b_val.length&&this.b_prec.pop(),t>=0)return c(3n,BigInt(-t));const e=Math.ceil(Math.log(-t)/Math.LN2)+10^0,n=BigInt(-e),r=t-e,i=BigInt(-r);let s=1n<<i,a=b.SQRT_HALF.get_appr(r),u=1n<<BigInt(-r-2),l=0;for(;s-a-4n>0n;){let e,o=s+a>>1n,h=s-o,p=s*a>>i,m=b.valueOfN(p).shiftRight(-r);if(this.b_prec.length===l+1){e=m.sqrt().get_appr(r);let i=c(e,n);this.b_prec.push(t),this.b_val.push(i)}else e=new O(m,this.b_prec[l+1],this.b_val[l+1]).get_appr(r),this.b_prec[l+1]=t,this.b_val[l+1]=c(e,n);s=o,a=e,u-=h*h<<BigInt(l+r),++l}let o=s+a;return c(o*o/u>>2n,n)}}p.ZERO=p.valueOfN(0n),p.ONE=p.valueOfN(1n),p.ten_ninths=p.valueOfN(10n).divide(p.valueOfN(9n)),p.twentyfive_twentyfourths=p.valueOfN(25n).divide(p.valueOfN(24n)),p.eightyone_eightyeths=p.valueOfN(81n).divide(p.valueOfN(80n)),p.ln2_1=p.valueOfN(7n).multiply(p.ten_ninths.simple_ln()),p.ln2_2=p.valueOfN(2n).multiply(p.twentyfive_twentyfourths.simple_ln()),p.ln2_3=p.valueOfN(3n).multiply(p.eightyone_eightyeths.simple_ln()),p.ln2=p.ln2_1.subtract(p.ln2_2).add(p.ln2_3),p.SQRT_HALF=new O(p.ONE.shiftRight(1)),p.four=p.valueOfN(4n),p.PI=new b,p.atan_PI=p.four.multiply(p.four.multiply(p.atan_reciprocal(5)).subtract(p.atan_reciprocal(239))),p.half_pi=p.PI.shiftRight(1);class B{}const x=Object.freeze({sinFunction:new class extends B{execute(t){return t.sin()}},cosFunction:new class extends B{execute(t){return t.cos()}},tanFunction:new class extends B{execute(t){return t.sin().divide(t.cos())}},asinFunction:new class extends B{execute(t){return t.asin()}},acosFunction:new class extends B{execute(t){return t.acos()}},atanFunction:new class extends B{constructor(){super(...arguments),this.one=p.ONE}execute(t){let e=t.multiply(t),n=e.divide(this.one.add(e)).sqrt();return t.select(n.negate(),n).asin()}}});class T{constructor(t,e=1n){this.mNum=t,this.mDen=e}static valueOfS(t,e){if(void 0===e&&(e=10),2!==e&&8!==e&&10!==e&&16!==e)throw new r("Radix: "+e);let n,i,s=t.length,a=0;for(;" "===t.charAt(a);)++a;for(;" "===t.charAt(s-1);)--s;n=t.indexOf(".",a),-1===n?(n=s,i=""):i=t.substring(n+1,s);let u,l=t.substring(a,n);switch(e){case 2:u=BigInt("0b"+l+i);break;case 8:u=BigInt("0o"+l+i);break;case 10:u=BigInt(l+i);break;case 16:u=BigInt("0x"+l+i)}let o=BigInt(e)**BigInt(i.length);return new T(u,o)}toString(){return this.mNum.toString()+"/"+this.mDen.toString()}toNiceString(){let t=this.reduce().positiveDen(),e=t.mNum.toString();return 1n!==t.mDen&&(e+="/"+t.mDen),e}static toString(t){return null===t?"not a small rational":t.toString()}toStringTruncated(t){let e=(a(this.mNum)*10n**BigInt(t)/a(this.mDen)).toString(),n=e.length;return n<t+1&&(e="0".repeat(t+1-n)+e,n=t+1),(this.signum()<0?"-":"")+e.substring(0,n-t)+"."+e.substring(n-t)}crValue(){return p.valueOfN(this.mNum).divide(p.valueOfN(this.mDen))}intValue(){let t=this.reduce();if(1n!==t.mDen)throw new n("intValue of non-int");return Number(t.mNum)}wholeNumberBits(){return 0n===this.mNum?-2147483648:o(this.mNum)-o(this.mDen)}tooBig(){return 1n!==this.mDen&&o(this.mNum)+o(this.mDen)>1e4}positiveDen(){return this.mDen>0n?this:new T(-this.mNum,-this.mDen)}reduce(){if(1n===this.mDen)return this;let t=function(t,e){let n;for(t=t<0n?-t:t,e=e<0n?-e:e;0n!==e;)n=e,e=t%e,t=n;return t}(this.mNum,this.mDen);return new T(this.mNum/t,this.mDen/t)}static maybeReduce(t){if(null===t)return null;if(!t.tooBig()&&Math.random()<1/16)return t;let e=t.positiveDen();return e=e.reduce(),e.tooBig()?null:e}compareTo(t){return u(this.mNum*t.mDen,t.mNum*this.mDen)*l(this.mDen)*l(t.mDen)}signum(){return l(this.mNum)*l(this.mDen)}equals(t){return null!==t&&0===this.compareTo(t)}static asBigInteger(t){return null===t?null:t.mNum%t.mDen===0n?t.mNum/t.mDen:null}static add(t,e){if(null===t||null===e)return null;let n=t.mDen*e.mDen,r=t.mNum*e.mDen+e.mNum*t.mDen;return T.maybeReduce(new T(r,n))}static negate(t){return null===t?null:new T(-t.mNum,t.mDen)}static subtract(t,e){return T.add(t,T.negate(e))}static rawMultiply(t,e){if(null===t||null===e)return null;if(t===T.ONE)return e;if(e===T.ONE)return t;let n=t.mNum*e.mNum,r=t.mDen*e.mDen;return new T(n,r)}static multiply(t,e){return T.maybeReduce(T.rawMultiply(t,e))}static inverse(t){if(null===t)return null;if(0n===t.mNum)throw new i;return new T(t.mDen,t.mNum)}static divide(t,e){return T.multiply(t,T.inverse(e))}static sqrt(t){if(null===t)return null;if((t=t.positiveDen().reduce()).mNum<0n)throw new n("sqrt(negative)");let e=Math.round(Math.sqrt(Number(t.mNum)));if(e===1/0)return null;let r=BigInt(e);if(r*r!==t.mNum)return null;let i=Math.round(Math.sqrt(Number(t.mDen)));if(i===1/0)return null;let s=BigInt(i);return s*s!==t.mDen?null:new T(r,s)}rawPow(t){if(1n===t)return this;if(1n===(1n&t))return T.rawMultiply(this.rawPow(t-1n),this);if(0n===t)return T.ONE;let e=this.rawPow(t>>1n),n=T.rawMultiply(e,e);return null===n||n.tooBig()?null:n}pow(t){let e=l(t);if(0===e)return T.ONE;if(1n===t)return this;let n=this.reduce().positiveDen();if(1n===n.mDen){if(0n===n.mNum)return T.ZERO;if(1n===n.mNum)return T.ONE;if(-1n===n.mNum)return 1n===(1n&t)?T.MINUS_ONE:T.ONE}return o(t)>1e3?null:e<0?T.inverse(n).rawPow(-t):n.rawPow(t)}static pow(t,e){return null===e||null===t||1n!==(e=e.reduce().positiveDen()).mDen?null:t.pow(e.mNum)}static digitsRequired(t){if(null===t)return 2147483647;let e=0,n=0;if(1n===t.mDen)return 0;let r=(t=t.reduce()).mDen;if(o(r)>1e4)return 2147483647;for(;0n===(1n&r);)++e,r>>=1n;for(;r%5n===0n;)++n,r/=5n;return 1n!==r&&-1n!==r?1e4:Math.max(e,n)}}T.ZERO=new T(0n),T.HALF=new T(1n,2n),T.MINUS_HALF=new T(-1n,2n),T.THIRD=new T(1n,3n),T.QUARTER=new T(1n,4n),T.SIXTH=new T(1n,6n),T.ONE=new T(1n),T.MINUS_ONE=new T(-1n),T.TWO=new T(2n),T.MINUS_TWO=new T(-2n),T.TEN=new T(10n),T.TWELVE=new T(12n);const S=1n<<1000n;class A{static check(t){if(!t)throw new s}constructor(t,e){if(null===t)throw new n("Building UnifiedReal from null");this.mCrFactor=e,this.mRatFactor=t}static newCR(t){return new A(T.ONE,t)}static newBR(t){return new A(t,A.CR_ONE)}static newN(t){return A.newBR(new T(t))}static getSquare(t){const e=A.sSqrts;for(let n=0;n<e.length;++n)if(e[n]===t)return new T(BigInt(n));return null}getExp(t){const e=A.sLogs;for(let n=0;n<e.length;++n)if(e[n]===t)return new T(BigInt(n));return null}static crName(t){if(t===A.CR_ONE)return"";if(t===A.CR_PI)return"π";if(t===A.CR_E)return"e";const e=A.sSqrts;for(let n=0;n<e.length;++n)if(t===e[n])return"√"+n;const n=A.sLogs;for(let e=0;e<n.length;++e)if(t===n[e])return"ln("+e+")";return null}static isNamed(t){if(t===A.CR_ONE||t===A.CR_PI||t===A.CR_E)return!0;const e=A.sSqrts;for(let n=0;n<e.length;++n)if(t===e[n])return!0;const n=A.sLogs;for(let e=0;e<n.length;++e)if(t===n[e])return!0;return!1}static definitelyAlgebraic(t){return t===A.CR_ONE||null!==A.getSquare(t)}definitelyRational(){return this.mCrFactor===A.CR_ONE||0===this.mRatFactor.signum()}definitelyIrrational(){return!this.definitelyRational()&&A.isNamed(this.mCrFactor)}definitelyAlgebraic(){return A.definitelyAlgebraic(this.mCrFactor)||0===this.mRatFactor.signum()}definitelyTranscendental(){return!this.definitelyAlgebraic()&&A.isNamed(this.mCrFactor)}static definitelyIndependent(t,e){return t!==e&&(t===A.CR_E||t===A.CR_PI?A.definitelyAlgebraic(e):e===A.CR_E||e===A.CR_PI?A.definitelyAlgebraic(t):A.isNamed(t)&&A.isNamed(e))}toString(){return this.mRatFactor.toString()+"*"+this.mCrFactor.toString()}toNiceString(){if(this.mCrFactor===A.CR_ONE||0===this.mRatFactor.signum())return this.mRatFactor.toNiceString();let t=A.crName(this.mCrFactor);if(null!==t){let e=T.asBigInteger(this.mRatFactor);return null!==e?1n===e?t:this.mRatFactor.toNiceString()+t:"("+this.mRatFactor.toNiceString()+")"+t}return this.mRatFactor===T.ONE?this.mCrFactor.toString():this.crValue().toString()}exactlyDisplayable(){return null!==A.crName(this.mCrFactor)}toStringTruncated(t){if(this.mCrFactor===A.CR_ONE||this.mRatFactor===T.ZERO)return this.mRatFactor.toStringTruncated(t);const e=p.valueOfN(10n**BigInt(t)).multiply(this.crValue());let n,r=!1;this.exactlyTruncatable()?(n=e.get_appr(0),n<0n&&(r=!0,n=-n),p.valueOfN(n).compareTo(e.abs())>0&&(n-=1n),A.check(p.valueOfN(n).compareTo(e.abs())<0)):(n=e.get_appr(-A.EXTRA_PREC),n<0n&&(r=!0,n=-n),n>>=A.EXTRA_PREC_BIG);let i=n.toString(),s=i.length;return s<t+1&&(i="0".repeat(t+1-s)+i,s=t+1),(r?"-":"")+i.substring(0,s-t)+"."+i.substring(s-t)}exactlyTruncatable(){return this.mCrFactor===A.CR_ONE||this.mRatFactor===T.ZERO||this.definitelyIrrational()}crValue(){return this.mRatFactor.crValue().multiply(this.mCrFactor)}isComparable(t){return this.mCrFactor===t.mCrFactor&&(A.isNamed(this.mCrFactor)||0!==this.mCrFactor.signumA(-1e3))||0===this.mRatFactor.signum()&&0===t.mRatFactor.signum()||A.definitelyIndependent(this.mCrFactor,t.mCrFactor)||0!==this.crValue().compareToA(t.crValue(),-1e3)}compareTo(t){return this.definitelyZero()&&t.definitelyZero()?0:this.mCrFactor===t.mCrFactor?this.mCrFactor.signum()*this.mRatFactor.compareTo(t.mRatFactor):this.crValue().compareTo(t.crValue())}compareToA(t,e){return this.isComparable(t)?this.compareTo(t):this.crValue().compareToA(t.crValue(),e)}signumA(t){return this.compareToA(A.ZERO,t)}signum(){return this.compareTo(A.ZERO)}approxEquals(t,e){return this.isComparable(t)?(!A.definitelyIndependent(this.mCrFactor,t.mCrFactor)||0===this.mRatFactor.signum()&&0===t.mRatFactor.signum())&&0===this.compareTo(t):0===this.crValue().compareToA(t.crValue(),e)}definitelyEquals(t){return this.isComparable(t)&&0===this.compareTo(t)}definitelyNotEquals(t){let e=A.isNamed(this.mCrFactor),n=A.isNamed(t.mCrFactor);return e&&n?A.definitelyIndependent(this.mCrFactor,t.mCrFactor)?0!==this.mRatFactor.signum()||0!==t.mRatFactor.signum():(this.mCrFactor,t.mCrFactor,!this.mRatFactor.equals(t.mRatFactor)):0===this.mRatFactor.signum()?n&&0!==t.mRatFactor.signum():0===t.mRatFactor.signum()&&e&&0!==this.mRatFactor.signum()}definitelyZero(){return 0===this.mRatFactor.signum()}definitelyNonZero(){return A.isNamed(this.mCrFactor)&&0!==this.mRatFactor.signum()}definitelyOne(){return this.mCrFactor===A.CR_ONE&&this.mRatFactor.equals(T.ONE)}boundedRationalValue(){return this.mCrFactor===A.CR_ONE||0===this.mRatFactor.signum()?this.mRatFactor:null}bigIntegerValue(){let t=this.boundedRationalValue();return T.asBigInteger(t)}add(t){if(this.mCrFactor===t.mCrFactor){let e=T.add(this.mRatFactor,t.mRatFactor);if(null!==e)return new A(e,this.mCrFactor)}return this.definitelyZero()?t:t.definitelyZero()?this:A.newCR(this.crValue().add(t.crValue()))}negate(){return new A(T.negate(this.mRatFactor),this.mCrFactor)}subtract(t){return this.add(t.negate())}multiply(t){if(this.mCrFactor===A.CR_ONE){let e=T.multiply(this.mRatFactor,t.mRatFactor);if(null!==e)return new A(e,t.mCrFactor)}if(t.mCrFactor===A.CR_ONE){let e=T.multiply(this.mRatFactor,t.mRatFactor);if(null!==e)return new A(e,this.mCrFactor)}if(this.definitelyZero()||t.definitelyZero())return A.ZERO;if(this.mCrFactor===t.mCrFactor){let e=A.getSquare(this.mCrFactor);if(null!==e){let n=T.multiply(T.multiply(e,this.mRatFactor),t.mRatFactor);if(null!==n)return A.newBR(n)}}let e=T.multiply(this.mRatFactor,t.mRatFactor);return null!==e?new A(e,this.mCrFactor.multiply(t.mCrFactor)):A.newCR(this.crValue().multiply(t.crValue()))}inverse(){if(this.definitelyZero())throw new i;let t=A.getSquare(this.mCrFactor);if(null!==t){let e=T.inverse(T.multiply(this.mRatFactor,t));if(null!==e)return new A(e,this.mCrFactor)}return new A(T.inverse(this.mRatFactor),this.mCrFactor.inverse())}divide(t){if(this.mCrFactor===t.mCrFactor){if(t.definitelyZero())throw new i;let e=T.divide(this.mRatFactor,t.mRatFactor);if(null!==e)return new A(e,A.CR_ONE)}return this.multiply(t.inverse())}sqrt(){if(this.definitelyZero())return A.ZERO;if(this.mCrFactor===A.CR_ONE){let t;for(let e=1;e<A.sSqrts.length;++e)if(null!==A.sSqrts[e]&&(t=T.sqrt(T.divide(this.mRatFactor,new T(BigInt(e)))),null!==t))return new A(t,A.sSqrts[e])}return A.newCR(this.crValue().sqrt())}getPiTwelfths(){if(this.definitelyZero())return 0n;if(this.mCrFactor===A.CR_PI){let t=T.asBigInteger(T.multiply(this.mRatFactor,T.TWELVE));return null===t?null:t%24n}return null}static sinPiTwelfths(t){if(t>=12){let e=A.sinPiTwelfths(t-12);return null===e?null:e.negate()}switch(t){case 0:return A.ZERO;case 2:case 10:return A.HALF;case 3:case 9:return A.HALF_SQRT2;case 4:case 8:return A.HALF_SQRT3;case 6:return A.ONE;default:return null}}sin(){let t=this.getPiTwelfths();if(null!==t){let e=A.sinPiTwelfths(Number(t));if(null!==e)return e}return A.newCR(this.crValue().sin())}static cosPiTwelfths(t){let e=t+6;return e>=24&&(e-=24),A.sinPiTwelfths(e)}cos(){let t=this.getPiTwelfths();if(null!==t){let e=A.cosPiTwelfths(Number(t));if(null!==e)return e}return A.newCR(this.crValue().cos())}tan(){let t=this.getPiTwelfths();if(null!==t){let e=Number(t);if(6===e||18===e)throw new n("Tangent undefined");let r=A.sinPiTwelfths(e),i=A.cosPiTwelfths(e);if(null!==r&&null!==i)return r.divide(i)}return this.sin().divide(this.cos())}checkAsinDomain(){if(this.isComparable(A.ONE)&&(this.compareTo(A.ONE)>0||this.compareTo(A.MINUS_ONE)<0))throw new n("inverse trig argument out of range")}static asinHalves(t){if(t<0)return this.asinHalves(-t).negate();switch(t){case 0:return A.ZERO;case 1:return new A(T.SIXTH,p.PI);case 2:return new A(T.HALF,p.PI)}throw new s("asinHalves: Bad argument")}asinNonHalves(){return this.compareToA(A.ZERO,-10)<0?this.negate().asinNonHalves().negate():this.definitelyEquals(A.HALF_SQRT2)?new A(T.QUARTER,A.CR_PI):this.definitelyEquals(A.HALF_SQRT3)?new A(T.THIRD,A.CR_PI):A.newCR(this.crValue().asin())}asin(){this.checkAsinDomain();const t=this.multiply(A.TWO).bigIntegerValue();return null!==t?A.asinHalves(Number(t)):this.mCrFactor===p.ONE||this.mCrFactor!==A.CR_SQRT2||this.mCrFactor!==A.CR_SQRT3?this.asinNonHalves():A.newCR(this.crValue().asin())}acos(){return A.PI_OVER_2.subtract(this.asin())}atan(){if(this.compareToA(A.ZERO,-10)<0)return this.negate().atan().negate();const t=this.bigIntegerValue();if(null!==t&&t<=1n)switch(Number(t)){case 0:return A.ZERO;case 1:return A.PI_OVER_4;default:throw new s("Impossible r_int")}return this.definitelyEquals(A.THIRD_SQRT3)?A.PI_OVER_6:this.definitelyEquals(A.SQRT3)?A.PI_OVER_3:A.newCR(x.atanFunction.execute(this.crValue()))}static recursivePow(t,e){if(1n===e)return t;if(0n!==(1n&e))return t.multiply(A.recursivePow(t,e-1n));let n=A.recursivePow(t,e>>1n);return n.multiply(n)}expLnPow(t){let e=this.signumA(-1e3);if(e>0)return A.newCR(this.crValue().ln().multiply(p.valueOfN(t)).exp());if(e<0){let e=this.crValue().negate().ln().multiply(p.valueOfN(t)).exp();return 0n!==(1n&t)&&(e=e.negate()),A.newCR(e)}return t<0n?A.newCR(A.recursivePow(this.crValue(),-t).inverse()):A.newCR(A.recursivePow(this.crValue(),t))}powN(t){if(1n===t)return this;if(0n===t)return A.ONE;let e=a(t);if(this.mCrFactor===A.CR_ONE&&e<=S){const e=this.mRatFactor.pow(t);if(null!==e)return A.newBR(e)}if(e>1000n)return this.expLnPow(t);let n=A.getSquare(this.mCrFactor);if(null!==n){const e=T.multiply(this.mRatFactor.pow(t),n.pow(t>>1n));if(null!==e)return 1n===(1n&t)?new A(e,this.mCrFactor):A.newBR(e)}return this.expLnPow(t)}pow(t){if(this.mCrFactor===A.CR_E){if(this.mRatFactor.equals(T.ONE))return t.exp();{let e=A.newBR(this.mRatFactor).pow(t);return t.exp().multiply(e)}}const e=t.boundedRationalValue();if(null!==e){let t=T.asBigInteger(e);if(null!==t)return this.powN(t);if(t=T.asBigInteger(T.multiply(T.TWO,e)),null!==t)return this.powN(t).sqrt()}if(this.definitelyZero())return A.ZERO;if(this.signumA(-1e3)<0)throw new n("Negative base for pow() with non-integer exponent");return A.newCR(this.crValue().ln().multiply(t.crValue()).exp())}static pow16(t){if(t>10)throw new s("Unexpected pow16 argument");let e=BigInt(t);return e*=e,e*=e,e*=e,e*=e,e}static getIntLog(t,e){let n=Number(t),r=Math.log(n)/Math.log(e);if(isFinite(n)&&Math.abs(r-Math.round(r))>1e-6)return 0n;let i=0n,s=BigInt(e),a=null;for(;t%s===0n;)for(t/=s,++i,null===a&&(a=A.pow16(e));t%a===0n;)t/=a,i+=16n;return 1n===t?i:0n}ln(){if(this.mCrFactor===A.CR_E)return new A(this.mRatFactor,A.CR_ONE).ln().add(A.ONE);if(this.isComparable(A.ZERO)){if(this.signum()<=0)throw new n("log(non-positive)");let t=this.compareToA(A.ONE,-1e3);if(0===t){if(this.definitelyEquals(A.ONE))return A.ZERO}else if(t<0)return this.inverse().ln().negate();const e=T.asBigInteger(this.mRatFactor);if(null!==e)if(this.mCrFactor===A.CR_ONE){const t=A.sLogs;for(let n=0;n<t.length;++n)if(null!==t[n]){let r=A.getIntLog(e,n);if(0n!==r)return new A(new T(r),t[n])}}else{let t=A.getSquare(this.mCrFactor);if(null!==t){let n=t.intValue();const r=A.sLogs;if(null!==r[n]){let t=A.getIntLog(e,n);if(0n!==t){let e=T.add(new T(t),T.HALF);if(null!==e)return new A(e,r[n])}}}}}return A.newCR(this.crValue().ln())}exp(){if(this.definitelyEquals(A.ZERO))return A.ONE;if(this.definitelyEquals(A.ONE))return A.E;const t=this.getExp(this.mCrFactor);if(null!==t){let e=!1,n=this.mRatFactor;null===T.asBigInteger(n)&&(e=!0,n=T.multiply(n,T.TWO));let r=T.pow(t,n);if(null!==r){let t=A.newBR(r);return e&&(t=t.sqrt()),t}}return A.newCR(this.crValue().exp())}static genFactorial(t,e){if(t>4n*e)return A.genFactorial(t,2n*e)*A.genFactorial(t-e,2n*e);{if(0n===t)return 1n;let n=t;for(let r=t-e;r>1n;r-=e)n*=r;return n}}fact(){let t=this.bigIntegerValue();if(null===t&&(t=this.crValue().get_appr(0),!this.approxEquals(A.newN(t),-1e3)))throw new n("Non-integral factorial argument");if(t<0n)throw new n("Negative factorial argument");if(o(t)>20)throw new n("Factorial argument too big");let e=A.genFactorial(t,1n),r=new T(e);return A.newBR(r)}digitsRequired(){return this.mCrFactor===A.CR_ONE||0===this.mRatFactor.signum()?T.digitsRequired(this.mRatFactor):2147483647}leadingBinaryZeroes(){if(A.isNamed(this.mCrFactor)){const t=this.mRatFactor.wholeNumberBits();return-2147483648===t?2147483647:t>=3?0:3-t}return 2147483647}approxWholeNumberBitsGreaterThan(t){return A.isNamed(this.mCrFactor)?this.mRatFactor.wholeNumberBits()>t:o(this.crValue().get_appr(t-2))>2}}A.CR_ONE=p.ONE,A.CR_PI=p.PI,A.CR_E=p.ONE.exp(),A.CR_SQRT2=p.valueOfN(2n).sqrt(),A.CR_SQRT3=p.valueOfN(3n).sqrt(),A.CR_LN2=p.valueOfN(2n).ln(),A.CR_LN3=p.valueOfN(3n).ln(),A.CR_LN5=p.valueOfN(5n).ln(),A.CR_LN6=p.valueOfN(6n).ln(),A.CR_LN7=p.valueOfN(7n).ln(),A.CR_LN10=p.valueOfN(10n).ln(),A.sSqrts=Object.freeze([null,p.ONE,A.CR_SQRT2,A.CR_SQRT3,null,p.valueOfN(5n).sqrt(),p.valueOfN(6n).sqrt(),p.valueOfN(7n).sqrt(),null,null,p.valueOfN(10n).sqrt()]),A.sLogs=Object.freeze([null,null,A.CR_LN2,A.CR_LN3,null,A.CR_LN5,A.CR_LN6,A.CR_LN7,null,null,A.CR_LN10]),A.PI=A.newCR(A.CR_PI),A.E=A.newCR(A.CR_E),A.ZERO=A.newBR(T.ZERO),A.ONE=A.newBR(T.ONE),A.MINUS_ONE=A.newBR(T.MINUS_ONE),A.TWO=A.newBR(T.TWO),A.MINUS_TWO=A.newBR(T.MINUS_TWO),A.HALF=A.newBR(T.HALF),A.MINUS_HALF=A.newBR(T.MINUS_HALF),A.TEN=A.newBR(T.TEN),A.RADIANS_PER_DEGREE=new A(new T(1n,180n),A.CR_PI),A.SIX=A.newN(6n),A.HALF_SQRT2=new A(T.HALF,A.CR_SQRT2),A.SQRT3=A.newCR(A.CR_SQRT3),A.HALF_SQRT3=new A(T.HALF,A.CR_SQRT3),A.THIRD_SQRT3=new A(T.THIRD,A.CR_SQRT3),A.PI_OVER_2=new A(T.HALF,A.CR_PI),A.PI_OVER_3=new A(T.THIRD,A.CR_PI),A.PI_OVER_4=new A(T.QUARTER,A.CR_PI),A.PI_OVER_6=new A(T.SIXTH,A.CR_PI),A.EXTRA_PREC=10,A.EXTRA_PREC_BIG=10n;const q={},P=A.E,D=A.TEN.ln(),V=A.RADIANS_PER_DEGREE,L=new Map,M=new Map,k=new Map,H=(new Map,new Map,new Map,new Map,new Map,new Map,{}),Z={},Q={},U={},z={},W=Object.freeze,j=postMessage;function X(t){let e=L.get(t);return void 0===e&&(e=A.newBR(T.valueOfS(t)),L.set(t,e)),e}function G(t){let e=L.get(t);return void 0===e&&(e=A.newN(t),L.set(t,e)),e}function J(t){let e=M.get(t);return void 0===e&&(e=t.negate(),M.set(t,e),M.set(e,t)),e}function K(t){let e=k.get(t);return void 0===e&&(e=t.fact(),k.set(t,e)),e}function Y(t,e){let n=t[e];return void 0===n&&(n={},t[e]=n),n}function $(t,e){const n=Y(H,t);let r=n[e];return void 0===r&&(r=t.add(e),n[e]=r,Y(H,e)[t]=r),r}function tt(t,e){const n=Y(Z,t);let r=n[e];return void 0===r&&(r=t.multiply(e),n[e]=r,Y(Z,e)[t]=r),r}function et(t,e){const n=Y(Q,t);let r=n[e];return void 0===r&&(r=t.divide(e),n[e]=r),r}function nt(t,e){const n=Y(U,t);let r=n[e];return void 0===r&&(r=t**e,n[e]=r),r}function rt(t,e){const n=Y(z,t);let r=n[e];return void 0===r&&(r=t===P?e.exp():t.pow(e),n[e]=r),r}function it(t){if(0===t.digitsRequired()){let e=t.bigIntegerValue();return null!==e||(e=t.crValue().get_appr(0),t.approxEquals(A.newN(e),-1e3))?e:null}return null}onmessage=function(t){const e=t.data;switch(e.type){case"createUR":try{let t=function(t,e){const n=W(new Set(["unary+","unary-","unary+pow","unary-pow","!"])),r=W(new Set(["+","-","*","/","^"])),i=W(new Set(["ln","log","exp","sqrt","sin","cos","tan","asin","acos","atan","arcsin","arccos","arctan"])),s=function(t){const e=[],n=[];let r,i,s=t.length,a="\0",u="",l=0;for(r=0;r<s;a=i,r++)if(i=t[r],i>="0"&&i<="9")if("\0"===a||"."===a||a>="0"&&a<="9")u+=i;else if("!"===a||")"===a||"π"===a||a>="a"&&a<="z")e.push(u),e.push("*"),n.push(W([r-u.length,r])),n.push(W([r,r])),u=i;else{if("("!==a&&"^"!==a&&"+"!==a&&"-"!==a&&"*"!==a&&"/"!==a&&"×"!==a&&"÷"!==a)throw new Error("Invalid lastChar '"+a+"' at position ("+r+")");u=i}else if(i>="a"&&i<="z"||"π"===i)if("\0"===a||"π"===a||a>="a"&&a<="z")u+=i;else if("!"===a||")"===a||"."===a||a>="0"&&a<="9")e.push(u),e.push("*"),n.push(W([r-u.length,r])),n.push(W([r,r])),u=i;else{if("("!==a&&"^"!==a&&"+"!==a&&"-"!==a&&"*"!==a&&"/"!==a&&"×"!==a&&"÷"!==a)throw new Error("Invalid lastChar '"+a+"' at position ("+r+")");u=i}else if("."===i)if("\0"===a||a>="0"&&a<="9"){if(u.indexOf(".")>=0)throw new Error("Invalid char '.' at position ("+r+")");u+="."}else if("!"===a||")"===a||"π"===a||a>="a"&&a<="z")e.push(u),e.push("*"),n.push(W([r-u.length,r])),n.push(W([r,r])),u=".";else{if("("!==a&&"^"!==a&&"+"!==a&&"-"!==a&&"*"!==a&&"/"!==a&&"×"!==a&&"÷"!==a)throw"."===a?new Error("Invalid char '.' at position ("+r+")"):new Error("Invalid lastChar '"+a+"' at position ("+r+")");u="."}else if("+"===i||"-"===i)if("."===a||"!"===a||")"===a||"π"===a||a>="a"&&a<="z"||a>="0"&&a<="9")e.push(u),e.push(i),n.push(W([r-u.length,r])),n.push(W([r,r+1])),u="";else{if("\0"!==a&&"("!==a&&"^"!==a&&"+"!==a&&"-"!==a&&"*"!==a&&"/"!==a&&"×"!==a&&"÷"!==a)throw new Error("Invalid lastChar '"+a+"' at position ("+r+")");e.push("^"===a?"unary"+i+"pow":"unary"+i),n.push(W([r,r+1])),u=""}else if("*"===i||"×"===i){if(!("."===a||"!"===a||")"===a||"π"===a||a>="a"&&a<="z"||a>="0"&&a<="9"))throw"\0"===a||"("===a||"^"===a||"+"===a||"-"===a||"*"===a||"/"===a||"×"===a||"÷"===a?new Error("Invalid char '"+i+"' at position ("+r+")"):new Error("Invalid lastChar '"+a+"' at position ("+r+")");e.push(u),e.push("*"),n.push(W([r-u.length,r])),n.push(W([r,r+1])),u=""}else if("/"===i||"÷"===i){if(!("."===a||"!"===a||")"===a||"π"===a||a>="a"&&a<="z"||a>="0"&&a<="9"))throw"\0"===a||"("===a||"^"===a||"+"===a||"-"===a||"*"===a||"/"===a||"×"===a||"÷"===a?new Error("Invalid char '"+i+"' at position ("+r+")"):new Error("Invalid lastChar '"+a+"' at position ("+r+")");e.push(u),e.push("/"),n.push(W([r-u.length,r])),n.push(W([r,r+1])),u=""}else if("^"===i){if(!("."===a||"!"===a||")"===a||"π"===a||a>="a"&&a<="z"||a>="0"&&a<="9"))throw"\0"===a||"("===a||"^"===a||"+"===a||"-"===a||"*"===a||"/"===a||"×"===a||"÷"===a?new Error("Invalid char '^' at position ("+r+")"):new Error("Invalid lastChar '"+a+"' at position ("+r+")");e.push(u),e.push("^"),n.push(W([r-u.length,r])),n.push(W([r,r+1])),u=""}else if("("===i){if("\0"===a||"("===a||"^"===a||"+"===a||"-"===a||"*"===a||"/"===a||"×"===a||"÷"===a)e.push("("),n.push(W([r,r+1])),u="";else if("."===a||"!"===a||")"===a||a>="0"&&a<="9")e.push(u),e.push("*"),e.push("("),n.push(W([r-u.length,r])),n.push(W([r,r])),n.push(W([r,r+1])),u="";else{if(!("π"===a||a>="a"&&a<="z"))throw new Error("Invalid lastChar '"+a+"' at position ("+r+")");e.push(u),e.push("("),n.push(W([r-u.length,r])),n.push(W([r,r+1])),u=""}l++}else if(")"===i||"!"===i){if(!("."===a||"!"===a||")"===a||"π"===a||a>="a"&&a<="z"||a>="0"&&a<="9"))throw"\0"===a||"("===a||"^"===a||"+"===a||"-"===a||"*"===a||"/"===a||"×"===a||"÷"===a?new Error("Invalid char '"+i+"' at position ("+r+")"):new Error("Invalid lastChar '"+a+"' at position ("+r+")");if(e.push(u),e.push(i),n.push(W([r-u.length,r])),n.push(W([r,r+1])),u="",")"===i&&(l--,l<0))throw new Error("Invalid char ')' at position ("+r+")")}else if(" "!==i)throw new Error("Unknown char '"+i+"' at position ("+r+")");u.length>0&&(e.push(u),n.push(W([s-u.length,s])));const o=[],h=[];for(s=e.length,r=0;r<s;r++){const t=e[r],i=n[r];if(""!==t){if(t.length>0&&"unary+"!==t&&"unary-"!==t&&"unary+pow"!==t&&"unary-pow"!==t){const e=t[0];if((e<"0"||e>"9")&&"."!==e){const e=t[t.length-1];let n;if(t.length>=6&&("n"===e||"s"===e)&&(n=t.substring(t.length-6),"arcsin"===n||"arccos"===n||"arctan"===n)){const e=Array.prototype.slice.call(t,0,t.length-6).join("*");o.push(...e);for(let t=0;t<e.length;t++)h.push(i);t.length>6&&(o.push("*"),h.push(i)),o.push(n),h.push(i);continue}if(t.length>=4&&("n"===e||"s"===e||"t"===e)&&(n=t.substring(t.length-4),"asin"===n||"acos"===n||"atan"===n||"sqrt"===n)){const e=Array.prototype.slice.call(t,0,t.length-4).join("*");o.push(...e);for(let t=0;t<e.length;t++)h.push(i);t.length>4&&(o.push("*"),h.push(i)),o.push(n),h.push(i);continue}if(t.length>=3&&("n"===e||"s"===e||"g"===e||"p"===e)&&(n=t.substring(t.length-3),"sin"===n||"cos"===n||"tan"===n||"log"===n||"exp"===n)){const e=Array.prototype.slice.call(t,0,t.length-3).join("*");o.push(...e);for(let t=0;t<e.length;t++)h.push(i);t.length>3&&(o.push("*"),h.push(i)),o.push(n),h.push(i);continue}if(t.length>=2&&"n"===e&&(n=t.substring(t.length-2),"ln"===n)){const e=Array.prototype.slice.call(t,0,t.length-2).join("*");o.push(...e);for(let t=0;t<e.length;t++)h.push(i);t.length>2&&(o.push("*"),h.push(i)),o.push(n),h.push(i);continue}const r=Array.prototype.join.call(t,"*");o.push(...r);for(let t=0;t<r.length;t++)h.push(i);continue}}o.push(t),h.push(i)}}if(l>0){const e=W([t.length,t.length]);for(;l--;)o.push(")"),h.push(e)}return{tokens:o,locations:h}}(t),a=function(t){const e=t.tokens,n=t.locations,r=e.length,i=W({"!":6,"unary+pow":5,"unary-pow":5,"^":4,"unary+":3,"unary-":3,"*":2,"/":2,"+":1,"-":1}),s=W(new Set(["ln","log","exp","sqrt","sin","cos","tan","asin","acos","atan","arcsin","arccos","arctan"])),a=W(new Set(["unary+","unary-","unary+pow","unary-pow","^"])),u=[],l=[];for(let t=0;t<r;t++){const r=e[t],o=n[t];if(s.has(r)||"("===r)l.push(W([r,o]));else if(")"===r){for(;l.length>0&&"("!==l[l.length-1][0];)u.push(l.pop());if(0===l.length)throw new Error("Mismatched parentheses at position ["+o+"]");l.pop(),l.length>0&&s.has(l[l.length-1][0])&&u.push(l.pop())}else if(i.hasOwnProperty(r)){const t=i[r],e=a.has(r);for(;l.length>0;){const n=l[l.length-1][0];if("("===n||s.has(n))break;const r=i[n]||0;if(!(e?r>t:r>=t))break;u.push(l.pop())}l.push(W([r,o]))}else u.push(W([r,o]))}for(;l.length>0;){const t=l.pop();if("("===t[0])throw new Error("Mismatched parentheses at position ["+t[1]+"]");u.push(t)}return u}(s),u=a.length,l=[];for(let t=0;t<u;t++){const s=a[t],u=s[0],o=s[1];if(r.has(u)){if(l.length<2)throw new Error("Insufficient number of parameters for operator '"+u+"' at position ["+o+"]");const t=l.pop(),e=l.pop();try{switch(u){case"+":l.push($(e,t));break;case"-":l.push($(e,J(t)));break;case"*":l.push(tt(e,t));break;case"/":l.push(et(e,t));break;case"^":if(0===e.digitsRequired()&&0===t.digitsRequired()){const n=it(e),r=it(t);if(n&&r&&r>=0){l.push(G(nt(n,r)));break}}l.push(rt(e,t))}}catch(t){throw console.error(t),new Error(t.message+" at position ["+o+"]")}}else if(n.has(u)){if(l.length<1)throw new Error("Insufficient number of parameters for operator '"+u+"' at position ["+o+"]");const t=l.pop();try{switch(u){case"unary+":case"unary+pow":l.push(t);break;case"unary-":case"unary-pow":l.push(J(t));break;case"!":l.push(K(t))}}catch(t){throw console.error(t),new Error(t.message+" at position ["+o+"]")}}else if(i.has(u)){if(l.length<1)throw new Error("Insufficient number of parameters for function '"+u+"' at position ["+o+"]");const t=l.pop();try{switch(u){case"ln":l.push(t.ln());break;case"log":l.push(t.ln().divide(D));break;case"exp":l.push(rt(P,t));break;case"sqrt":l.push(t.sqrt());break;case"sin":e?l.push(t.multiply(V).sin()):l.push(t.sin());break;case"cos":e?l.push(t.multiply(V).cos()):l.push(t.cos());break;case"tan":e?l.push(t.multiply(V).tan()):l.push(t.tan());break;case"asin":case"arcsin":e?l.push(t.asin().divide(V)):l.push(t.asin());break;case"acos":case"arccos":e?l.push(t.acos().divide(V)):l.push(t.acos());break;case"atan":case"arctan":e?l.push(t.atan().divide(V)):l.push(t.atan())}}catch(t){throw console.error(t),new Error(t.message+" at position ["+o+"]")}}else{const t=u[0];if("."===t||t>="0"&&t<="9")l.push(X("."===t?"0"+u:u));else if("e"===u)l.push(P);else{if("π"!==u)throw new Error("Unknown variable '"+u+"' at position ["+o+"]");l.push(A.PI)}}}if(1!=l.length)throw new Error("Invalid stack length: "+l.length);return l.pop()}(e.expr,e.degreeMode);q[e.id]=t;let n=t.digitsRequired();j({type:"createUR",id:e.id,uid:e.uid,expr:e.expr,degreeMode:e.degreeMode,digitsRequired:n,success:!0})}catch(t){j({type:"createUR",id:e.id,uid:e.uid,expr:e.expr,degreeMode:e.degreeMode,error:String(t)})}break;case"copyUR":q[e.id]=q[e.fromId];break;case"removeUR":delete q[e.id];break;case"toStringTruncated":try{let t=q[e.id].toStringTruncated(e.prec);j({type:"toStringTruncated",id:e.id,uid:e.uid,prec:e.prec,result:t})}catch(t){j({type:"toStringTruncated",id:e.id,uid:e.uid,prec:e.prec,error:String(t)})}}},j({type:"init"})})();